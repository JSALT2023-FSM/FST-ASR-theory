<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        JSALT 2023 - FSM - CodiMD
    </title>
    <link rel="icon" type="image/png" href="https://codimd.math.cnrs.fr/favicon.png">
    <link rel="apple-touch-icon" href="https://codimd.math.cnrs.fr/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/css/bootstrap.min.css" integrity="sha256-H0KfTigpUV+0/5tn2HXC0CPwhhDhWgSawJdnFd0CGCo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fork-awesome/1.1.3/css/fork-awesome.min.css" integrity="sha256-ZhApazu+kejqTYhMF+1DzNKjIzP7KXu6AzyXcC1gMus=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.night .markdown-body blockquote{color:#bcbcbc}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.night .markdown-body h1,.night .markdown-body h2,.night .markdown-body h3,.night .markdown-body h4,.night .markdown-body h5,.night .markdown-body h6{color:#ddd}.markdown-body h1 .fa-link,.markdown-body h2 .fa-link,.markdown-body h3 .fa-link,.markdown-body h4 .fa-link,.markdown-body h5 .fa-link,.markdown-body h6 .fa-link{color:#000;vertical-align:middle;visibility:hidden;font-size:16px}.night .markdown-body h1 .fa-link,.night .markdown-body h2 .fa-link,.night .markdown-body h3 .fa-link,.night .markdown-body h4 .fa-link,.night .markdown-body h5 .fa-link,.night .markdown-body h6 .fa-link{color:#fff}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .fa-link,.markdown-body h2:hover .anchor .fa-link,.markdown-body h3:hover .anchor .fa-link,.markdown-body h4:hover .anchor .fa-link,.markdown-body h5:hover .anchor .fa-link,.markdown-body h6:hover .anchor .fa-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.night .markdown-body table tr{background-color:#5f5f5f}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.night .markdown-body table tr:nth-child(2n){background-color:#4f4f4f}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.night .markdown-body code,.night .markdown-body tt{color:#eee;background-color:hsla(0,0%,90.2%,.36)}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.night .markdown-body pre{filter:invert(100%)}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-webkit-inline-flex;display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.night .markdown-body .gist table tr:nth-child(2n){background-color:#ddd}.markdown-body code[data-gist-id]{background:none;padding:0;filter:invert(100%)}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.geo,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.night .markdown-body pre.graphviz .graph>polygon{fill:#333}.night .markdown-body pre.mermaid .sectionTitle,.night .markdown-body pre.mermaid .titleText,.night .markdown-body pre.mermaid text{fill:#fff}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.night .markdown-body .abc path{fill:#eee}.night .markdown-body .abc path.note_selected{fill:##4DD0E1}.night tspan{fill:#fefefe}.night pre rect{fill:transparent}.night pre.flow-chart path,.night pre.flow-chart rect{stroke:#fff}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body img{background-color:transparent}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;-webkit-transition:opacity .2s;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;-webkit-transition:opacity .2s;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.geo-map{width:100%;height:250px}.markmap-container{height:300px}.markmap-container>svg{width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.9;background-color:#ccc;border:none}.ui-toc-label,.ui-toc .open .ui-toc-label{-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#5f5f5f}.ui-toc-label:focus{opacity:1;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.night .ui-toc-dropdown .nav>li>a:focus,.night .ui-toc-dropdown .nav>li>a:hover{color:#fff;border-left-color:#fff}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.night .ui-toc-dropdown .nav>.active:focus>a,.night .ui-toc-dropdown .nav>.active:hover>a,.night .ui-toc-dropdown .nav>.active>a{color:#fff;border-left:2px solid #fff}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.night .ui-toc-dropdown .nav>li>a{color:#aaa}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:50px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a{padding-right:50px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:60px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a{padding-right:60px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a:hover{padding-left:49px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a:hover{padding-right:49px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a:hover{padding-left:59px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a:hover{padding-right:59px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>a{padding-left:48px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.active>.nav>.nav>.active>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active:hover>a{padding-right:48px}.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active>a{padding-left:58px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.active>.nav>.nav>.active>.nav>.active>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:hover>a{padding-right:58px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,"\30D2\30E9\30AE\30CE\89D2\30B4   Pro W3",Osaka,Meiryo,"\30E1\30A4\30EA\30AA",MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,"\5FAE\8EDF\6B63\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,"\5FAE\8EDF\6B63\9ED1UI",sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,"\5FAE\8F6F\96C5\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,"\5FAE\8F6F\96C5\9ED1UI",sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:rgba(0,0,0,.85)}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}small span{line-height:22px}small .dropdown{display:inline-block}small .dropdown a:focus,small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}.night .navbar{background:#333;border-bottom-color:#333;color:#eee}.night .navbar a{color:#eee}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid" lang="en"><p><em>Lucas ONDEL YANG, LISN, CNRS, Université Paris-Saclay</em><br>
February 24, 2023</p><p></p><div class="toc" data-toc-depth="2"><ul>
<li><a href="#A-Modern-View-of-FSA" title="A Modern View of FSA">A Modern View of FSA</a><ul>
<li><a href="#Finite-State-Automata" title="Finite State Automata">Finite State Automata</a></li>
<li><a href="#Regain-of-Interest-for-FSA" title="Regain of Interest for FSA">Regain of Interest for FSA</a></li>
<li><a href="#A-Different-Path" title="A Different Path">A Different Path</a></li>
</ul>
</li>
<li><a href="#Linear-Algebraic-Framework-for-FSA" title="Linear Algebraic Framework for FSA">Linear Algebraic Framework for FSA</a><ul>
<li><a href="#Challenges" title="Challenges">Challenges</a></li>
<li><a href="#Dual-representation-of-FSA" title="Dual representation of FSA">Dual representation of FSA</a></li>
<li><a href="#Matrix-representation" title="Matrix representation">Matrix representation</a></li>
<li><a href="#Implementing-a-FSA-based-Loss-Function" title="Implementing a FSA-based Loss Function">Implementing a FSA-based Loss Function</a></li>
<li><a href="#Representing-“ε”" title="Representing “ε”">Representing “ε”</a></li>
<li><a href="#Building-the-decoding-graph" title="Building the decoding graph">Building the decoding graph</a></li>
<li><a href="#Inference-with-neural-networks" title="Inference with neural networks">Inference with neural networks</a></li>
<li><a href="#Current-implementation" title="Current implementation">Current implementation</a></li>
</ul>
</li>
<li><a href="#Workshop" title="Workshop">Workshop</a><ul>
<li><a href="#Common-objective" title="Common objective">Common objective</a></li>
<li><a href="#Preparation" title="Preparation">Preparation</a></li>
</ul>
</li>
</ul>
</div><p></p><h1 id="A-Modern-View-of-FSA"><a class="anchor hidden-xs" href="#A-Modern-View-of-FSA" title="A-Modern-View-of-FSA"><i class="fa fa-link"></i></a>A Modern View of FSA</h1><h2 id="Finite-State-Automata"><a class="anchor hidden-xs" href="#Finite-State-Automata" title="Finite-State-Automata"><i class="fa fa-link"></i></a>Finite State Automata</h2><ul>
<li>Still competitive:
<ul>
<li><a href="https://getalp.github.io/LeBenchmark-webpage/leaderboard/" target="_blank" rel="noopener">https://getalp.github.io/LeBenchmark-webpage/leaderboard/</a></li>
</ul>
</li>
<li>Powerful features:
<ul>
<li>Theoretical ground for building highly complex sytems, e.g. ASR decoder.</li>
<li>Modularization of speech processing pipeline.</li>
<li>Allows to represent uncertainty.</li>
</ul>
</li>
<li>Difficult to integrate with neural architecture pipelines:
<ul>
<li>how to support “modern” hardware, i.e. SIMD capable devices ?</li>
<li>how to easily compute the gradient from FSA-based losses ?</li>
</ul>
</li>
</ul><h2 id="Regain-of-Interest-for-FSA"><a class="anchor hidden-xs" href="#Regain-of-Interest-for-FSA" title="Regain-of-Interest-for-FSA"><i class="fa fa-link"></i></a>Regain of Interest for FSA</h2><blockquote>
<p><a href="https://arxiv.org/abs/2010.01003" target="_blank" rel="noopener"><em>Differentiable Weighted Finite-State Transducer,<br>
A. Hannun et al, 2020</em></a></p>
</blockquote><ul>
<li><a href="https://github.com/gtn-org/gtn" target="_blank" rel="noopener">GTN</a> - May 31, 2020:
<ul>
<li>Automatic differentiation.</li>
<li>CUDA support.</li>
<li>FST or FSA ?</li>
</ul>
</li>
<li><a href="https://github.com/k2-fsa/k2" target="_blank" rel="noopener">k2</a> - April 12, 2020:
<ul>
<li>Automatic differentiation.</li>
<li>CUDA support.</li>
<li>No FST, FSA.</li>
</ul>
</li>
</ul><h2 id="A-Different-Path"><a class="anchor hidden-xs" href="#A-Different-Path" title="A-Different-Path"><i class="fa fa-link"></i></a>A Different Path</h2><blockquote>
<p><a href="https://arxiv.org/abs/2112.00709" target="_blank" rel="noopener"><em>GPU-Accelerated Forward-Backward algorithm with Application to Lattice-Free MMI<br>
L. Ondel et al, 2021</em></a></p>
</blockquote><ul>
<li>Using sparse matrices in a given semiring to implement the forward-backward algorithm:
<ul>
<li>Performance</li>
<li>Flexibility and Accessibility</li>
</ul>
</li>
<li>A complete FSA framework relying on (sparse) linear algebra ?</li>
</ul><h1 id="Linear-Algebraic-Framework-for-FSA"><a class="anchor hidden-xs" href="#Linear-Algebraic-Framework-for-FSA" title="Linear-Algebraic-Framework-for-FSA"><i class="fa fa-link"></i></a>Linear Algebraic Framework for FSA</h1><h2 id="Challenges"><a class="anchor hidden-xs" href="#Challenges" title="Challenges"><i class="fa fa-link"></i></a>Challenges</h2><ul>
<li>Representing FSA in terms of matrices / vectors
<ul>
<li>semiring and matrices ?</li>
<li>epsilon arcs ?</li>
</ul>
</li>
<li>Building FSA, i.e. matrix-based algorithms for:
<ul>
<li>union</li>
<li>concatentation</li>
<li>replacement</li>
<li>determinization</li>
<li>renormalization (a.k.a. weight-pushing)</li>
<li>…</li>
</ul>
</li>
<li>Learning, Inference
<ul>
<li>intersection</li>
</ul>
</li>
</ul><h2 id="Dual-representation-of-FSA"><a class="anchor hidden-xs" href="#Dual-representation-of-FSA" title="Dual-representation-of-FSA"><i class="fa fa-link"></i></a>Dual representation of FSA</h2><pre class="graphviz"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="372pt" height="77pt" viewBox="0.00 0.00 371.74 77.24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 73.2397)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-73.2397 367.7409,-73.2397 367.7409,4 -4,4"></polygon>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="#000000" stroke-width="2" cx="30.6198" cy="-34.6198" rx="30.7401" ry="30.7401"></ellipse>
<text text-anchor="middle" x="30.6198" y="-30.4198" font-family="Times,serif" font-size="14.00" fill="#000000">1/0.5</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="#000000" cx="132.3449" cy="-34.6198" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="132.3449" y="-30.4198" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- n1&#45;&gt;n2 -->
<g id="edge1" class="edge">
<title>n1-&gt;n2</title>
<path fill="none" stroke="#000000" d="M61.4167,-34.6198C74.8482,-34.6198 90.503,-34.6198 103.6832,-34.6198"></path>
<polygon fill="#000000" stroke="#000000" points="104.0695,-38.1199 114.0694,-34.6198 104.0694,-31.1199 104.0695,-38.1199"></polygon>
<text text-anchor="middle" x="87.7923" y="-38.8198" font-family="Times,serif" font-size="14.00" fill="#000000">a/2</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="#000000" cx="223.3961" cy="-34.6198" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="223.3961" y="-30.4198" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- n2&#45;&gt;n3 -->
<g id="edge2" class="edge">
<title>n2-&gt;n3</title>
<path fill="none" stroke="#000000" d="M150.7704,-34.6198C163.4415,-34.6198 180.5162,-34.6198 194.9259,-34.6198"></path>
<polygon fill="#000000" stroke="#000000" points="195.3087,-38.1199 205.3086,-34.6198 195.3086,-31.1199 195.3087,-38.1199"></polygon>
<text text-anchor="middle" x="177.8705" y="-38.8198" font-family="Times,serif" font-size="14.00" fill="#000000">ε/2</text>
</g>
<!-- n2&#45;&gt;n3 -->
<g id="edge3" class="edge">
<title>n2-&gt;n3</title>
<path fill="none" stroke="#000000" d="M146.9793,-23.8265C153.2314,-19.8561 160.8151,-15.8387 168.3449,-13.8198 176.5232,-11.627 179.2177,-11.627 187.3961,-13.8198 191.6315,-14.9554 195.8841,-16.7234 199.9071,-18.7596"></path>
<polygon fill="#000000" stroke="#000000" points="198.3438,-21.8976 208.7616,-23.8265 201.8205,-15.822 198.3438,-21.8976"></polygon>
<text text-anchor="middle" x="177.8705" y="-17.8198" font-family="Times,serif" font-size="14.00" fill="#000000">b/3</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<ellipse fill="none" stroke="#000000" cx="329.1211" cy="-34.6198" rx="30.7262" ry="30.7262"></ellipse>
<ellipse fill="none" stroke="#000000" cx="329.1211" cy="-34.6198" rx="34.7401" ry="34.7401"></ellipse>
<text text-anchor="middle" x="329.1211" y="-30.4198" font-family="Times,serif" font-size="14.00" fill="#000000">4/0.6</text>
</g>
<!-- n3&#45;&gt;n4 -->
<g id="edge4" class="edge">
<title>n3-&gt;n4</title>
<path fill="none" stroke="#000000" d="M241.8119,-34.6198C253.5408,-34.6198 269.2769,-34.6198 284.1584,-34.6198"></path>
<polygon fill="#000000" stroke="#000000" points="284.2648,-38.1199 294.2647,-34.6198 284.2647,-31.1199 284.2648,-38.1199"></polygon>
<text text-anchor="middle" x="267.9487" y="-38.8198" font-family="Times,serif" font-size="14.00" fill="#000000">c/4</text>
</g>
</g>
</svg>
</pre><ol>
<li>Edges become nodes with weight 1.</li>
<li>Multiply incoming arcs’ weight by the state weight.</li>
<li>Remove sates with epsilon labels.</li>
</ol><pre class="graphviz"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="348pt" height="122pt" viewBox="0.00 0.00 347.90 121.55" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 117.5548)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-117.5548 343.8968,-117.5548 343.8968,4 -4,4"></polygon>
<!-- n0 -->
<g id="node1" class="node">
<title>n0</title>
<ellipse fill="#000000" stroke="#000000" cx="1.8" cy="-56.3771" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- n1 -->
<g id="node2" class="node">
<title>n1</title>
<ellipse fill="none" stroke="#000000" cx="79.9354" cy="-56.3771" rx="22.6719" ry="22.6719"></ellipse>
<text text-anchor="middle" x="79.9354" y="-52.1771" font-family="Times,serif" font-size="14.00" fill="#000000">a/2</text>
</g>
<!-- n0&#45;&gt;n1 -->
<g id="edge1" class="edge">
<title>n0-&gt;n1</title>
<path fill="none" stroke="#000000" d="M3.7314,-56.3771C9.7821,-56.3771 29.0176,-56.3771 46.6473,-56.3771"></path>
<polygon fill="#000000" stroke="#000000" points="46.7302,-59.8772 56.7301,-56.3771 46.7301,-52.8772 46.7302,-59.8772"></polygon>
<text text-anchor="middle" x="30.35" y="-60.5771" font-family="Times,serif" font-size="14.00" fill="#000000">0.5</text>
</g>
<!-- n2 -->
<g id="node3" class="node">
<title>n2</title>
<ellipse fill="none" stroke="#000000" cx="169.9484" cy="-89.3771" rx="24.3567" ry="24.3567"></ellipse>
<text text-anchor="middle" x="169.9484" y="-85.1771" font-family="Times,serif" font-size="14.00" fill="#000000">ε/2</text>
</g>
<!-- n1&#45;&gt;n2 -->
<g id="edge2" class="edge">
<title>n1-&gt;n2</title>
<path fill="none" stroke="#000000" d="M101.725,-64.3655C112.4563,-68.2997 125.6126,-73.123 137.4988,-77.4807"></path>
<polygon fill="#000000" stroke="#000000" points="136.5097,-80.8458 147.1034,-81.0018 138.9192,-74.2735 136.5097,-80.8458"></polygon>
<text text-anchor="middle" x="124.2707" y="-77.5771" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- n3 -->
<g id="node4" class="node">
<title>n3</title>
<ellipse fill="none" stroke="#000000" cx="169.9484" cy="-23.3771" rx="23.2549" ry="23.2549"></ellipse>
<text text-anchor="middle" x="169.9484" y="-19.1771" font-family="Times,serif" font-size="14.00" fill="#000000">b/3</text>
</g>
<!-- n1&#45;&gt;n3 -->
<g id="edge3" class="edge">
<title>n1-&gt;n3</title>
<path fill="none" stroke="#000000" d="M101.725,-48.3887C112.6189,-44.3949 126.0119,-39.4848 138.0382,-35.0758"></path>
<polygon fill="#000000" stroke="#000000" points="139.5499,-38.2495 147.7341,-31.5212 137.1404,-31.6772 139.5499,-38.2495"></polygon>
<text text-anchor="middle" x="124.2707" y="-45.5771" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- n4 -->
<g id="node5" class="node">
<title>n4</title>
<ellipse fill="none" stroke="#000000" cx="259.9614" cy="-56.3771" rx="22.6719" ry="22.6719"></ellipse>
<text text-anchor="middle" x="259.9614" y="-52.1771" font-family="Times,serif" font-size="14.00" fill="#000000">c/4</text>
</g>
<!-- n2&#45;&gt;n4 -->
<g id="edge4" class="edge">
<title>n2-&gt;n4</title>
<path fill="none" stroke="#000000" d="M192.6625,-81.0498C203.6484,-77.0222 217.0051,-72.1255 228.9144,-67.7594"></path>
<polygon fill="#000000" stroke="#000000" points="230.3098,-70.9757 238.494,-64.2474 227.9003,-64.4034 230.3098,-70.9757"></polygon>
<text text-anchor="middle" x="215.6261" y="-77.5771" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- n3&#45;&gt;n4 -->
<g id="edge5" class="edge">
<title>n3-&gt;n4</title>
<path fill="none" stroke="#000000" d="M192.1988,-31.5344C203.1805,-35.5605 216.6152,-40.4858 228.6176,-44.8861"></path>
<polygon fill="#000000" stroke="#000000" points="227.6839,-48.2715 238.2776,-48.4275 230.0934,-41.6992 227.6839,-48.2715"></polygon>
<text text-anchor="middle" x="215.6261" y="-45.5771" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- n5 -->
<g id="node6" class="node">
<title>n5</title>
<ellipse fill="#000000" stroke="#000000" cx="338.0968" cy="-56.3771" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- n4&#45;&gt;n5 -->
<g id="edge6" class="edge">
<title>n4-&gt;n5</title>
<path fill="none" stroke="#000000" d="M282.982,-56.3771C296.9594,-56.3771 314.2536,-56.3771 325.7012,-56.3771"></path>
<polygon fill="#000000" stroke="#000000" points="325.9049,-59.8772 335.9049,-56.3771 325.9049,-52.8772 325.9049,-59.8772"></polygon>
<text text-anchor="middle" x="309.5468" y="-60.5771" font-family="Times,serif" font-size="14.00" fill="#000000">0.6</text>
</g>
</g>
</svg>
</pre><pre class="graphviz"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="341pt" height="98pt" viewBox="0.00 0.00 340.70 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-94 336.7,-94 336.7,4 -4,4"></polygon>
<!-- n0 -->
<g id="node1" class="node">
<title>n0</title>
<ellipse fill="#000000" stroke="#000000" cx="1.8" cy="-45" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- n1 -->
<g id="node2" class="node">
<title>n1</title>
<ellipse fill="none" stroke="#000000" cx="99.6" cy="-45" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="99.6" y="-40.8" font-family="Times,serif" font-size="14.00" fill="#000000">a</text>
</g>
<!-- n0&#45;&gt;n1 -->
<g id="edge1" class="edge">
<title>n0-&gt;n1</title>
<path fill="none" stroke="#000000" d="M3.8427,-45C12.4353,-45 46.3575,-45 71.3988,-45"></path>
<polygon fill="#000000" stroke="#000000" points="71.4874,-48.5001 81.4873,-45 71.4873,-41.5001 71.4874,-48.5001"></polygon>
<text text-anchor="middle" x="42.6" y="-49.2" font-family="Times,serif" font-size="14.00" fill="#000000">0.5 ⊗ 2</text>
</g>
<!-- n2 -->
<g id="node3" class="node">
<title>n2</title>
<ellipse fill="none" stroke="#000000" cx="178.6" cy="-72" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="178.6" y="-67.8" font-family="Times,serif" font-size="14.00" fill="#000000">ε</text>
</g>
<!-- n1&#45;&gt;n2 -->
<g id="edge2" class="edge">
<title>n1-&gt;n2</title>
<path fill="none" stroke="#000000" d="M116.7418,-50.8586C126.9906,-54.3613 140.2336,-58.8874 151.8353,-62.8526"></path>
<polygon fill="#000000" stroke="#000000" points="150.8971,-66.2306 161.4916,-66.1528 153.161,-59.6068 150.8971,-66.2306"></polygon>
<text text-anchor="middle" x="139.1" y="-63.2" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- n3 -->
<g id="node4" class="node">
<title>n3</title>
<ellipse fill="none" stroke="#000000" cx="178.6" cy="-18" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="178.6" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#000000">b</text>
</g>
<!-- n1&#45;&gt;n3 -->
<g id="edge3" class="edge">
<title>n1-&gt;n3</title>
<path fill="none" stroke="#000000" d="M116.7418,-39.1414C126.9906,-35.6387 140.2336,-31.1126 151.8353,-27.1474"></path>
<polygon fill="#000000" stroke="#000000" points="153.161,-30.3932 161.4916,-23.8472 150.8971,-23.7694 153.161,-30.3932"></polygon>
<text text-anchor="middle" x="139.1" y="-37.2" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- n4 -->
<g id="node5" class="node">
<title>n4</title>
<ellipse fill="none" stroke="#000000" cx="257.6" cy="-45" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="257.6" y="-40.8" font-family="Times,serif" font-size="14.00" fill="#000000">c</text>
</g>
<!-- n2&#45;&gt;n4 -->
<g id="edge4" class="edge">
<title>n2-&gt;n4</title>
<path fill="none" stroke="#000000" d="M195.7418,-66.1414C205.9906,-62.6387 219.2336,-58.1126 230.8353,-54.1474"></path>
<polygon fill="#000000" stroke="#000000" points="232.161,-57.3932 240.4916,-50.8472 229.8971,-50.7694 232.161,-57.3932"></polygon>
</g>
<!-- n3&#45;&gt;n4 -->
<g id="edge5" class="edge">
<title>n3-&gt;n4</title>
<path fill="none" stroke="#000000" d="M195.7418,-23.8586C205.9906,-27.3613 219.2336,-31.8874 230.8353,-35.8526"></path>
<polygon fill="#000000" stroke="#000000" points="229.8971,-39.2306 240.4916,-39.1528 232.161,-32.6068 229.8971,-39.2306"></polygon>
<text text-anchor="middle" x="218.1" y="-37.2" font-family="Times,serif" font-size="14.00" fill="#000000">4</text>
</g>
<!-- n5 -->
<g id="node6" class="node">
<title>n5</title>
<ellipse fill="#000000" stroke="#000000" cx="330.9" cy="-45" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- n4&#45;&gt;n5 -->
<g id="edge6" class="edge">
<title>n4-&gt;n5</title>
<path fill="none" stroke="#000000" d="M275.7191,-45C289.1265,-45 307.0239,-45 318.7493,-45"></path>
<polygon fill="#000000" stroke="#000000" points="319.0399,-48.5001 329.0399,-45 319.0399,-41.5001 319.0399,-48.5001"></polygon>
<text text-anchor="middle" x="302.35" y="-49.2" font-family="Times,serif" font-size="14.00" fill="#000000">0.6</text>
</g>
</g>
</svg>
</pre><pre class="graphviz"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="341pt" height="81pt" viewBox="0.00 0.00 340.70 81.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 77)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-77 336.7,-77 336.7,4 -4,4"></polygon>
<!-- n0 -->
<g id="node1" class="node">
<title>n0</title>
<ellipse fill="#000000" stroke="#000000" cx="1.8" cy="-18" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- n1 -->
<g id="node2" class="node">
<title>n1</title>
<ellipse fill="none" stroke="#000000" cx="99.6" cy="-18" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="99.6" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#000000">a</text>
</g>
<!-- n0&#45;&gt;n1 -->
<g id="edge1" class="edge">
<title>n0-&gt;n1</title>
<path fill="none" stroke="#000000" d="M3.8427,-18C12.4353,-18 46.3575,-18 71.3988,-18"></path>
<polygon fill="#000000" stroke="#000000" points="71.4874,-21.5001 81.4873,-18 71.4873,-14.5001 71.4874,-21.5001"></polygon>
<text text-anchor="middle" x="42.6" y="-22.2" font-family="Times,serif" font-size="14.00" fill="#000000">0.5 ⊗ 2</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="#000000" cx="178.6" cy="-55" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="178.6" y="-50.8" font-family="Times,serif" font-size="14.00" fill="#000000">b</text>
</g>
<!-- n1&#45;&gt;n3 -->
<g id="edge3" class="edge">
<title>n1-&gt;n3</title>
<path fill="none" stroke="#000000" d="M115.9689,-25.6664C126.6672,-30.6771 140.861,-37.3248 153.0312,-43.0247"></path>
<polygon fill="#000000" stroke="#000000" points="151.7116,-46.2715 162.2521,-47.3434 154.6807,-39.9323 151.7116,-46.2715"></polygon>
<text text-anchor="middle" x="139.1" y="-41.2" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<ellipse fill="none" stroke="#000000" cx="257.6" cy="-18" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="257.6" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#000000">c</text>
</g>
<!-- n1&#45;&gt;n4 -->
<g id="edge2" class="edge">
<title>n1-&gt;n4</title>
<path fill="none" stroke="#000000" d="M117.4397,-15.483C129.5789,-13.9004 146.0239,-12.0099 160.6,-11.2 176.5754,-10.3123 180.6246,-10.3123 196.6,-11.2 207.4182,-11.8011 219.2659,-12.9975 229.6186,-14.2214"></path>
<polygon fill="#000000" stroke="#000000" points="229.4047,-17.7217 239.7603,-15.483 230.2689,-10.7752 229.4047,-17.7217"></polygon>
<text text-anchor="middle" x="178.6" y="-16.2" font-family="Times,serif" font-size="14.00" fill="#000000">2 ⊗ 4</text>
</g>
<!-- n3&#45;&gt;n4 -->
<g id="edge4" class="edge">
<title>n3-&gt;n4</title>
<path fill="none" stroke="#000000" d="M194.9689,-47.3336C205.6672,-42.3229 219.861,-35.6752 232.0312,-29.9753"></path>
<polygon fill="#000000" stroke="#000000" points="233.6807,-33.0677 241.2521,-25.6566 230.7116,-26.7285 233.6807,-33.0677"></polygon>
<text text-anchor="middle" x="218.1" y="-41.2" font-family="Times,serif" font-size="14.00" fill="#000000">4</text>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<ellipse fill="#000000" stroke="#000000" cx="330.9" cy="-18" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- n4&#45;&gt;n5 -->
<g id="edge5" class="edge">
<title>n4-&gt;n5</title>
<path fill="none" stroke="#000000" d="M275.7191,-18C289.1265,-18 307.0239,-18 318.7493,-18"></path>
<polygon fill="#000000" stroke="#000000" points="319.0399,-21.5001 329.0399,-18 319.0399,-14.5001 319.0399,-21.5001"></polygon>
<text text-anchor="middle" x="302.35" y="-22.2" font-family="Times,serif" font-size="14.00" fill="#000000">0.6</text>
</g>
</g>
</svg>
</pre><h2 id="Matrix-representation"><a class="anchor hidden-xs" href="#Matrix-representation" title="Matrix-representation"><i class="fa fa-link"></i></a>Matrix representation</h2><p>a FSA <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>A</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.67em, 2.462em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="texatom" id="MathJax-Span-3"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5" style="font-family: STIXNonUnicode-Italic;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1">\mathcal{A}</script></span> can be represented by a 5-tuple:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>A</mi></mrow><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B1;</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mo>,</mo><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi><mo>,</mo><mi>&amp;#x03C1;</mi><mo>,</mo><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 9.07em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.431em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.693em, 1007.38em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="texatom" id="MathJax-Span-8"><span class="mrow" id="MathJax-Span-9"><span class="mi" id="MathJax-Span-10" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mo" id="MathJax-Span-12" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">(</span><span class="mi" id="MathJax-Span-13" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span><span class="mo" id="MathJax-Span-14" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-15" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span class="mo" id="MathJax-Span-18" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-19" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.207em;">ω</span><span class="mo" id="MathJax-Span-20" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-21" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">ρ</span><span class="mo" id="MathJax-Span-22" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-23" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.207em;">λ</span><span class="mo" id="MathJax-Span-24" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">α</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mo>,</mo><mi mathvariant="bold-italic">ω</mi><mo>,</mo><mi>ρ</mi><mo>,</mo><mi mathvariant="bold-italic">λ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">
\mathcal{A} = (\boldsymbol{\alpha}, \mathbf{T}, \boldsymbol{\omega}, \rho, \boldsymbol{\lambda}) 
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B1;</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>0.5</mn><mo>&amp;#x2297;</mo><mn>2</mn></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mtd><mtd><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr><mtr><mtd><mn>0.6</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mn>3</mn></mtd><mtd><mn>2</mn><mo>&amp;#x2297;</mo><mn>4</mn></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mn>4</mn></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mtd><mtd><mi>&amp;#x03C1;</mi></mtd><mtd><mi></mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr><mtr><mtd><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03BB;</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mtext>a</mtext></mtd></mtr><mtr><mtd><mtext>b</mtext></mtd></mtr><mtr><mtd><mtext>c</mtext></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 19.316em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.832em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-4.506em, 1015.63em, 8.455em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mtable" id="MathJax-Span-27" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 15.525em; height: 0px;"><span style="position: absolute; clip: rect(5.279em, 1000.62em, 14.757em, -999.997em); top: -10.192em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -8.297em; right: 0em;"><span class="mtd" id="MathJax-Span-28"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.942em; right: 0em;"><span class="mtd" id="MathJax-Span-86"><span class="mrow" id="MathJax-Span-87"><span class="texatom" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: 0.412em; right: 0em;"><span class="mtd" id="MathJax-Span-164"><span class="mrow" id="MathJax-Span-165"><span class="mi" id="MathJax-Span-166" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">λ</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.197em;"></span></span><span style="position: absolute; clip: rect(6.97em, 1008.1em, 19.931em, -999.997em); top: -13.676em; left: 0.669em;"><span style="display: inline-block; position: relative; width: 8.148em; height: 0px;"><span style="position: absolute; clip: rect(2.615em, 1005.59em, 6.919em, -999.997em); top: -9.321em; left: 0em;"><span class="mtd" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33"></span><span class="mo" id="MathJax-Span-34" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-35" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-36" style="vertical-align: 2.257em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.305em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.073em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-37" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px;"><span style="position: absolute; clip: rect(2.41em, 1003.08em, 6.457em, -999.997em); top: -4.711em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1003.08em, 4.255em, -999.997em); top: -5.428em; left: 50%; margin-left: -1.534em;"><span class="mtd" id="MathJax-Span-38"><span class="mrow" id="MathJax-Span-39"><span class="mn" id="MathJax-Span-40" style="font-family: STIXGeneral-Regular;">0.5</span><span class="mo" id="MathJax-Span-41" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mn" id="MathJax-Span-42" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -3.942em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-43"><span class="mrow" id="MathJax-Span-44"><span class="texatom" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="munderover" id="MathJax-Span-47"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-48" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-49" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -2.456em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="munderover" id="MathJax-Span-54"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-55" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-56" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span></span></span><span class="mo" id="MathJax-Span-57" style="vertical-align: 2.257em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.305em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.073em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.023em;"></span></span><span style="position: absolute; clip: rect(2.615em, 1008.1em, 7.021em, -999.997em); top: -5.018em; left: 0em;"><span class="mtd" id="MathJax-Span-91"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93"></span><span class="mo" id="MathJax-Span-94" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-95" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-96" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.254em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.022em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-97" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 5.638em; height: 0px;"><span style="position: absolute; clip: rect(2.41em, 1000.46em, 6.611em, -999.997em); top: -4.864em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -5.428em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-98"><span class="mrow" id="MathJax-Span-99"><span class="texatom" id="MathJax-Span-100"><span class="mrow" id="MathJax-Span-101"><span class="munderover" id="MathJax-Span-102"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-103" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-104" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -3.891em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-113"><span class="mrow" id="MathJax-Span-114"><span class="texatom" id="MathJax-Span-115"><span class="mrow" id="MathJax-Span-116"><span class="munderover" id="MathJax-Span-117"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-118" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-119" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="texatom" id="MathJax-Span-132"><span class="mrow" id="MathJax-Span-133"><span class="munderover" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-135" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-136" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.869em;"></span></span><span style="position: absolute; clip: rect(2.462em, 1000.46em, 6.457em, -999.997em); top: -4.711em; left: 1.642em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -5.428em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mn" id="MathJax-Span-107" style="font-family: STIXGeneral-Regular;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -3.891em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-120"><span class="mrow" id="MathJax-Span-121"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="munderover" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-125" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-126" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-137"><span class="mrow" id="MathJax-Span-138"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="munderover" id="MathJax-Span-141"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-142" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-143" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span><span style="position: absolute; clip: rect(2.462em, 1002.36em, 6.457em, -999.997em); top: -4.711em; left: 3.23em;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1002.36em, 4.255em, -999.997em); top: -5.428em; left: 50%; margin-left: -1.176em;"><span class="mtd" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mn" id="MathJax-Span-110" style="font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-111" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mn" id="MathJax-Span-112" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.891em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="mn" id="MathJax-Span-129" style="font-family: STIXGeneral-Regular;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="texatom" id="MathJax-Span-146"><span class="mrow" id="MathJax-Span-147"><span class="munderover" id="MathJax-Span-148"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-149" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-150" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span></span></span><span class="mo" id="MathJax-Span-151" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.254em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.022em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.074em;"></span></span><span style="position: absolute; clip: rect(2.564em, 1002.97em, 6.765em, -999.997em); top: -0.51em; left: 0em;"><span class="mtd" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169"></span><span class="mo" id="MathJax-Span-170" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-171" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-172" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-173" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(2.359em, 1000.46em, 5.996em, -999.997em); top: -4.352em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -5.377em; left: 50%; margin-left: -0.202em;"><span class="mtd" id="MathJax-Span-174"><span class="mrow" id="MathJax-Span-175"><span class="mtext" id="MathJax-Span-176" style="font-family: STIXGeneral-Regular;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.942em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mtext" id="MathJax-Span-179" style="font-family: STIXGeneral-Regular;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -2.508em; left: 50%; margin-left: -0.202em;"><span class="mtd" id="MathJax-Span-180"><span class="mrow" id="MathJax-Span-181"><span class="mtext" id="MathJax-Span-182" style="font-family: STIXGeneral-Regular;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.357em;"></span></span></span></span><span class="mo" id="MathJax-Span-183" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.921em;"></span></span></span><span style="display: inline-block; width: 0px; height: 13.681em;"></span></span><span style="position: absolute; clip: rect(1.13em, 1000.67em, 6.457em, -999.997em); top: -6.043em; left: 11.068em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -8.297em; right: 0em;"><span class="mtd" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.357em, -999.997em); top: -3.942em; right: 0em;"><span class="mtd" id="MathJax-Span-152"><span class="mrow" id="MathJax-Span-153"><span class="mi" id="MathJax-Span-154" style="font-family: STIXGeneral-Italic;">ρ</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.048em;"></span></span><span style="position: absolute; clip: rect(0.925em, 1003.74em, 7.841em, -999.997em); top: -7.631em; left: 11.785em;"><span style="display: inline-block; position: relative; width: 3.794em; height: 0px;"><span style="position: absolute; clip: rect(2.615em, 1003.74em, 6.919em, -999.997em); top: -9.321em; left: 0em;"><span class="mtd" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63"></span><span class="mo" id="MathJax-Span-64" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-65" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-66" style="vertical-align: 2.257em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.305em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.073em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-67" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(2.41em, 1001.23em, 6.56em, -999.997em); top: -4.813em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -5.377em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-68"><span class="mrow" id="MathJax-Span-69"><span class="texatom" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="munderover" id="MathJax-Span-72"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-73" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-74" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -3.891em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="munderover" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-80" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-81" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1001.23em, 4.152em, -999.997em); top: -2.456em; left: 50%; margin-left: -0.612em;"><span class="mtd" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mn" id="MathJax-Span-84" style="font-family: STIXGeneral-Regular;">0.6</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.818em;"></span></span></span></span><span class="mo" id="MathJax-Span-85" style="vertical-align: 2.257em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.305em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.073em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.023em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1001.8em, 4.152em, -999.997em); top: -3.942em; left: 0em;"><span class="mtd" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157"></span><span class="mo" id="MathJax-Span-158" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="texatom" id="MathJax-Span-159" style="padding-left: 0.31em;"><span class="mrow" id="MathJax-Span-160"><span class="munderover" id="MathJax-Span-161"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-162" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-163" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.636em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -7.497em; border-left: 0px solid; width: 0px; height: 15.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi mathvariant="bold-italic">α</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0.5</mn><mo>⊗</mo><mn>2</mn></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mtd><mtd><mi mathvariant="bold-italic">ω</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr><mtr><mtd><mn>0.6</mn></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mn>3</mn></mtd><mtd><mn>2</mn><mo>⊗</mo><mn>4</mn></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mn>4</mn></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mtd><mtd><mi>ρ</mi></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr><mtr><mtd><mi mathvariant="bold-italic">λ</mi></mtd><mtd><mi></mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mtext>a</mtext></mtd></mtr><mtr><mtd><mtext>b</mtext></mtd></mtr><mtr><mtd><mtext>c</mtext></mtd></mtr></mtable><mo>]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">
\begin{align}
\boldsymbol{\alpha} &= \begin{bmatrix}
    0.5 \otimes 2 \\
    \bar{0} \\
    \bar{0} 
\end{bmatrix} & \boldsymbol{\omega} &= \begin{bmatrix} \bar{0} \\ \bar{0} \\ 0.6 \end{bmatrix} \\
\mathbf{T} &= \begin{bmatrix}
    \bar{0} & 3 & 2 \otimes 4 \\
    \bar{0} & \bar{0} & 4 \\
    \bar{0} & \bar{0} & \bar{0}
\end{bmatrix} & \rho &= \bar{0} \\
\boldsymbol{\lambda} &= \begin{bmatrix} \text{a} \\ \text{b} \\ \text{c} \end{bmatrix}
\end{align} 
</script></span></p><p>We note <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-184" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.72em, 2.615em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-185"><span class="mi" id="MathJax-Span-186" style="font-family: STIXGeneral-Italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">Q</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>D</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-187" style="width: 7.789em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.355em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1006.25em, 2.615em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-190" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mo" id="MathJax-Span-191" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">{</span><span class="mn" id="MathJax-Span-192" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-193" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">.</span><span class="mo" id="MathJax-Span-195" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">.</span><span class="mo" id="MathJax-Span-196" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">.</span><span class="mo" id="MathJax-Span-197" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">,</span><span class="mi" id="MathJax-Span-198" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">D</span><span class="mo" id="MathJax-Span-199" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo>=</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>D</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">Q = \{1, ..., D\}</script></span> where <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-200" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.72em, 2.41em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-family: STIXGeneral-Italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">D</script></span> is the number of states, the set of states of the automaton.</p><h2 id="Implementing-a-FSA-based-Loss-Function"><a class="anchor hidden-xs" href="#Implementing-a-FSA-based-Loss-Function" title="Implementing-a-FSA-based-Loss-Function"><i class="fa fa-link"></i></a>Implementing a FSA-based Loss Function</h2><p>Most of the FSA-based loss function (e.g. MMI, sMBR) imply compute the <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2295;</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-203" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1000.72em, 2.564em, -999.997em); top: -2.303em; left: 0em;"><span class="mrow" id="MathJax-Span-204"><span class="mo" id="MathJax-Span-205" style="font-family: STIXGeneral-Regular;">⊕</span></span><span style="display: inline-block; width: 0px; height: 2.308em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⊕</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">\oplus</script></span>-sum of weights of all the paths in an automaton <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>A</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-206" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.67em, 2.462em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-207"><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-family: STIXNonUnicode-Italic;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-8">\mathcal{A}</script></span>. an be computed with the following recursion:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B1;</mi></mtd></mtr><mtr><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><mi>W</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>&amp;#x03C1;</mi><mo>&amp;#x2295;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;>[</mo></mrow><munderover><mo>&amp;#x2A01;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>+</mo><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mi>i</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;>]</mo></mrow></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-211" style="width: 13.373em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.966em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-1.124em, 1010.5em, 5.074em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-212"><span class="mtable" id="MathJax-Span-213" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 10.658em; height: 0px;"><span style="position: absolute; clip: rect(2.41em, 1002.36em, 7.175em, -999.997em); top: -5.428em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.92em, 4.306em, -999.997em); top: -6.401em; right: 0em;"><span class="mtd" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-217"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-220" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.92em, 4.306em, -999.997em); top: -4.967em; right: 0em;"><span class="mtd" id="MathJax-Span-226"><span class="mrow" id="MathJax-Span-227"><span class="msubsup" id="MathJax-Span-228"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-229"><span class="mrow" id="MathJax-Span-230"><span class="mi" id="MathJax-Span-231" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1002.36em, 4.306em, -999.997em); top: -2.61em; right: 0em;"><span class="mtd" id="MathJax-Span-253"><span class="mrow" id="MathJax-Span-254"><span class="mi" id="MathJax-Span-255" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-256" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mi" id="MathJax-Span-259" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-260" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.433em;"></span></span><span style="position: absolute; clip: rect(3.537em, 1007.94em, 9.429em, -999.997em); top: -6.555em; left: 2.41em;"><span style="display: inline-block; position: relative; width: 8.251em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1001.9em, 4.152em, -999.997em); top: -6.401em; left: 0em;"><span class="mtd" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223"></span><span class="mo" id="MathJax-Span-224" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-225" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.31em;">α</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1004.31em, 4.408em, -999.997em); top: -4.967em; left: 0em;"><span class="mtd" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237"></span><span class="mo" id="MathJax-Span-238" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-239" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-240"><span class="mrow" id="MathJax-Span-241"><span class="mi" id="MathJax-Span-242" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.669em;"><span class="mi" id="MathJax-Span-243" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-244"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-245"><span class="mrow" id="MathJax-Span-246"><span class="mi" id="MathJax-Span-247" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-251" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-252" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.154em, 1007.94em, 5.535em, -999.997em); top: -2.713em; left: 0em;"><span class="mtd" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263"></span><span class="mo" id="MathJax-Span-264" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-265" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">ρ</span><span class="mo" id="MathJax-Span-266" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊕</span><span class="texatom" id="MathJax-Span-267" style="padding-left: 0.259em;"><span class="mrow" id="MathJax-Span-268"><span class="mo" id="MathJax-Span-269" style="vertical-align: -0.766em;"><span style="font-family: STIXSizeFourSym;">[</span></span></span></span><span class="munderover" id="MathJax-Span-270" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.49em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-271" style="font-family: STIXSizeOneSym; vertical-align: -0.51em;">⨁</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.98em, 4.255em, -999.997em); top: -2.866em; left: 0.259em;"><span class="texatom" id="MathJax-Span-272"><span class="mrow" id="MathJax-Span-273"><span class="mi" id="MathJax-Span-274" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-275" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-276" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.08em, 4.203em, -999.997em); top: -5.172em; left: 0.207em;"><span class="texatom" id="MathJax-Span-277"><span class="mrow" id="MathJax-Span-278"><span class="mo" id="MathJax-Span-279" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-280" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-281" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-282"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.26em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mi" id="MathJax-Span-286" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-287" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span><span class="texatom" id="MathJax-Span-288"><span class="mrow" id="MathJax-Span-289"><span class="mo" id="MathJax-Span-290" style="vertical-align: -0.766em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.101em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.56em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.372em; border-left: 0px solid; width: 0px; height: 7.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mi mathvariant="bold-italic">α</mi></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub></mtd><mtd><mi></mi><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi mathvariant="normal">⊤</mi></msup><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><mi>W</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>ρ</mi><mo>⊕</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.470em" minsize="2.470em">[</mo></mrow><munderover><mo>⨁</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></munderover><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><mi mathvariant="bold-italic">ω</mi><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.470em" minsize="2.470em">]</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">
\begin{align}
    \mathbf{v}_1 &= \boldsymbol{\alpha} \\
    \mathbf{v}_{n} &= \mathbf{T}^\top \mathbf{v}_{n-1} \\
    W(\mathcal{A}) &= \rho \oplus \Bigg[ \bigoplus_{i=1}^{+\infty} \mathbf{v}_i^\top \boldsymbol{\omega} \Bigg] 
\end{align}
</script></span></p><pre><code class="julia hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Base</span>.<span class="hljs-title">sum</span><span class="hljs-params">(A::AbstractFSA; init = α<span class="hljs-params">(A)</span>, n = nstates<span class="hljs-params">(A)</span>)</span>
    <span class="hljs-title">v</span> = <span class="hljs-title">init</span>
    <span class="hljs-title">W</span> = <span class="hljs-title">dot</span><span class="hljs-params">(v, ω<span class="hljs-params">(A)</span>)</span> + ρ<span class="hljs-params">(A)</span>
    <span class="hljs-title">for</span> <span class="hljs-title">i</span> <span class="hljs-title">in</span> 1:<span class="hljs-title">n</span>
        <span class="hljs-title">v</span> = <span class="hljs-title">T</span><span class="hljs-params">(A)</span>' * <span class="hljs-title">v</span>
        <span class="hljs-title">W</span> += <span class="hljs-title">dot</span><span class="hljs-params">(v, ω<span class="hljs-params">(A)</span>)</span>
    <span class="hljs-title">end</span>
    <span class="hljs-title">W</span>
<span class="hljs-title">end</span>
</span></code></pre><p>Another form:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>W</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>&amp;#x03C1;</mi><mo>&amp;#x2295;</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mn>1</mn><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn></mrow></msup><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi><mo>&amp;#x2295;</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mn>2</mn><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mn>1</mn></msup><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi><mo>&amp;#x2295;</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mn>3</mn><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mn>2</mn></msup><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi><mo>&amp;#x2295;</mo><mo>&amp;#x2026;</mo><mspace linebreak=&quot;newline&quot; /></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-291" style="width: 100%; display: inline-block; min-width: 23.619em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.974em, 1019.21em, 5.33em, -999.997em); top: -3.993em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-292"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1019.21em, 4.46em, -999.997em); top: -3.993em; left: 50%; margin-left: -9.68em;"><span class="mi" id="MathJax-Span-293" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-294" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-295"><span class="mrow" id="MathJax-Span-296"><span class="mi" id="MathJax-Span-297" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-298" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-299" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-300" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">ρ</span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊕</span><span class="msubsup" id="MathJax-Span-302" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-303"><span class="mrow" id="MathJax-Span-304"><span class="mi" id="MathJax-Span-305" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-306" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mn" id="MathJax-Span-307" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-308"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-309"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.669em;"><span class="texatom" id="MathJax-Span-312"><span class="mrow" id="MathJax-Span-313"><span class="mn" id="MathJax-Span-314" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-315" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span><span class="mo" id="MathJax-Span-316" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊕</span><span class="msubsup" id="MathJax-Span-317" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-318"><span class="mrow" id="MathJax-Span-319"><span class="mi" id="MathJax-Span-320" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-321" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mn" id="MathJax-Span-322" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.669em;"><span class="mn" id="MathJax-Span-327" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-328" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span><span class="mo" id="MathJax-Span-329" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊕</span><span class="msubsup" id="MathJax-Span-330" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-331"><span class="mrow" id="MathJax-Span-332"><span class="mi" id="MathJax-Span-333" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-334" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mn" id="MathJax-Span-335" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-336"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.669em;"><span class="mn" id="MathJax-Span-340" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-341" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span><span class="mo" id="MathJax-Span-342" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊕</span><span class="mo" id="MathJax-Span-343" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">…</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.815em; left: 50%; margin-left: 0em;"><span class="mspace" id="MathJax-Span-344" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 2.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>W</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>ρ</mi><mo>⊕</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mn>1</mn><mi mathvariant="normal">⊤</mi></msubsup><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msup><mi mathvariant="bold-italic">ω</mi><mo>⊕</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mn>2</mn><mi mathvariant="normal">⊤</mi></msubsup><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mn>1</mn></msup><mi mathvariant="bold-italic">ω</mi><mo>⊕</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mn>3</mn><mi mathvariant="normal">⊤</mi></msubsup><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mn>2</mn></msup><mi mathvariant="bold-italic">ω</mi><mo>⊕</mo><mo>…</mo><mspace linebreak="newline"></mspace></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">
W(\mathcal{A}) = \rho \oplus \mathbf{v}_1^\top \mathbf{T}^{0} \boldsymbol{\omega} \oplus \mathbf{v}_2^\top \mathbf{T}^1 \boldsymbol{\omega} \oplus \mathbf{v}_3^\top \mathbf{T}^2 \boldsymbol{\omega} \oplus \dots \\
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>A</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-345" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.67em, 2.462em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-346"><span class="texatom" id="MathJax-Span-347"><span class="mrow" id="MathJax-Span-348"><span class="mi" id="MathJax-Span-349" style="font-family: STIXNonUnicode-Italic;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-11">\mathcal{A}</script></span> is acyclic <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mspace width=&quot;thickmathspace&quot; /><mo stretchy=&quot;false&quot;>&amp;#x27FA;</mo><mspace width=&quot;thickmathspace&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-350" style="width: 3.332em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.718em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.67em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-351"><span class="mspace" id="MathJax-Span-352" style="height: 0em; vertical-align: 0em; width: 0.31em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-353" style="font-family: STIXGeneral-Regular;">⟺</span><span class="mspace" id="MathJax-Span-354" style="height: 0em; vertical-align: 0em; width: 0.31em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-355" style="padding-left: 0.31em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mspace width="thickmathspace"></mspace><mo stretchy="false">⟺</mo><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-12">\iff \mathbf{T}</script></span> is nilpotent, i.e. <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>k</mi></msup><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>0</mn></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-358" style="width: 3.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.769em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1002.77em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-359"><span class="msubsup" id="MathJax-Span-360"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-361"><span class="mrow" id="MathJax-Span-362"><span class="mi" id="MathJax-Span-363" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.669em;"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-365" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="texatom" id="MathJax-Span-366" style="padding-left: 0.31em;"><span class="mrow" id="MathJax-Span-367"><span class="mn" id="MathJax-Span-368" style="font-family: STIXGeneral; font-weight: bold;">0</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>k</mi></msup><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">0</mn></mrow></math></span></span><script type="math/tex" id="MathJax-Element-13">\mathbf{T}^k = \mathbf{0}</script></span> for some <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-369" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.51em, 2.41em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">k</script></span>. Therefore, for an acyclic automaton:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>W</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>&amp;#x03C1;</mi><mo>&amp;#x2295;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;>[</mo></mrow><munderover><mo>&amp;#x2A01;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C0;</mi></mrow></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></munderover><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mi>i</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;>]</mo></mrow><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-372" style="width: 16.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.835em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.259em, 1013.63em, 3.64em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-373"><span class="mtable" id="MathJax-Span-374" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 13.527em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1002.36em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1002.36em, 4.306em, -999.997em); top: -3.993em; right: 0em;"><span class="mtd" id="MathJax-Span-375"><span class="mrow" id="MathJax-Span-376"><span class="mi" id="MathJax-Span-377" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-378" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-379"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-family: STIXNonUnicode-Italic;"></span></span></span><span class="mo" id="MathJax-Span-382" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.154em, 1011.02em, 5.535em, -999.997em); top: -4.096em; left: 2.41em;"><span style="display: inline-block; position: relative; width: 11.119em; height: 0px;"><span style="position: absolute; clip: rect(2.103em, 1011.02em, 5.535em, -999.997em); top: -4.096em; left: 0em;"><span class="mtd" id="MathJax-Span-383"><span class="mrow" id="MathJax-Span-384"><span class="mi" id="MathJax-Span-385"></span><span class="mo" id="MathJax-Span-386" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-387" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">ρ</span><span class="mo" id="MathJax-Span-388" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊕</span><span class="texatom" id="MathJax-Span-389" style="padding-left: 0.259em;"><span class="mrow" id="MathJax-Span-390"><span class="mo" id="MathJax-Span-391" style="vertical-align: -0.766em;"><span style="font-family: STIXSizeFourSym;">[</span></span></span></span><span class="munderover" id="MathJax-Span-392" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 2.615em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.49em, 4.613em, -999.997em); top: -3.993em; left: 0.515em;"><span class="mo" id="MathJax-Span-393" style="font-family: STIXSizeOneSym; vertical-align: -0.51em;">⨁</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.98em, 4.255em, -999.997em); top: -2.866em; left: 0.771em;"><span class="texatom" id="MathJax-Span-394"><span class="mrow" id="MathJax-Span-395"><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-397" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-398" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1002.51em, 4.306em, -999.997em); top: -5.223em; left: 0em;"><span class="texatom" id="MathJax-Span-399"><span class="mrow" id="MathJax-Span-400"><span class="munderover" id="MathJax-Span-401"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1001.18em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-402" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 1.232em;"><span class="texatom" id="MathJax-Span-403"><span class="mrow" id="MathJax-Span-404"><span class="mi" id="MathJax-Span-405" style="font-size: 50%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-406" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-407"><span class="mo" id="MathJax-Span-408" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-409" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; font-weight: bold;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-410"><span class="mrow" id="MathJax-Span-411"><span class="mo" id="MathJax-Span-412" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-413" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-414"><span class="mrow" id="MathJax-Span-415"><span class="mi" id="MathJax-Span-416" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-417" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.26em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mi" id="MathJax-Span-418" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-419"><span style="display: inline-block; position: relative; width: 1.796em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-420"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.669em;"><span class="texatom" id="MathJax-Span-423"><span class="mrow" id="MathJax-Span-424"><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-426" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-427" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-428" style=""><span class="mrow" id="MathJax-Span-429"><span class="mo" id="MathJax-Span-430" style="vertical-align: -0.766em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span><span class="mi" id="MathJax-Span-431" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span></span></span><span style="display: inline-block; width: 0px; height: 4.101em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.101em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>W</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">A</mi></mrow><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>ρ</mi><mo>⊕</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.470em" minsize="2.470em">[</mo></mrow><munderover><mo>⨁</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">π</mi></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi mathvariant="bold-italic">π</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></munderover><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mo maxsize="2.470em" minsize="2.470em">]</mo></mrow><mi mathvariant="bold-italic">ω</mi></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">
\begin{align}
   W(\mathcal{A}) &= \rho \oplus \Bigg[\bigoplus_{i=1}^{\max_{\boldsymbol{\pi}} | \boldsymbol{\pi}| } \mathbf{v}^\top_i \mathbf{T}^{i-1} \Bigg] \boldsymbol{\omega}
\end{align}
</script></span></p><blockquote>
<p><mark><em>Combining FSA with neural networks requires to ensure that computing the product <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-432" style="width: 2.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.735em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.454em, 1001.74em, 2.625em, -999.998em); top: -2.48em; left: 0em;"><span class="mrow" id="MathJax-Span-433"><span class="msubsup" id="MathJax-Span-434"><span style="display: inline-block; position: relative; width: 1.22em; height: 0px;"><span style="position: absolute; clip: rect(3.187em, 1000.66em, 4.124em, -999.998em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-435"><span class="mrow" id="MathJax-Span-436"><span class="mi" id="MathJax-Span-437" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.4em; left: 0.658em;"><span class="mi" id="MathJax-Span-438" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-439"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.485em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.054em; border-left: 0px solid; width: 0px; height: 1.203em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\mathbf{T}^\top \mathbf{v}</script></span> is “feasible”.</em></mark></p>
</blockquote><h3 id="Challenges1"><a class="anchor hidden-xs" href="#Challenges1" title="Challenges1"><i class="fa fa-link"></i></a>Challenges</h3><ul>
<li>Sparse linear algebra for abitrary semiring with SIMD support:
<ul>
<li>Julia language solves the problem (<strong>can operate with python using DLPack</strong>)</li>
</ul>
</li>
<li>Just relying on the sparsity of <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-442" style="width: 0.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1000.62em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="texatom" id="MathJax-Span-444"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-17">\mathbf{T}</script></span> is not enough:
<ul>
<li>Representing “ε”</li>
<li>Dynamic building of the decoding graph</li>
<li>Intersecting <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mi>L</mi><mi>G</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-447" style="width: 2.564em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1002.1em, 2.41em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-448"><span class="mi" id="MathJax-Span-449" style="font-family: STIXGeneral-Italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-450" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-451" style="font-family: STIXGeneral-Italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mi>L</mi><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">HLG</script></span> with the neural network ouput (ref GNAT)</li>
</ul>
</li>
</ul><h2 id="Representing-“ε”"><a class="anchor hidden-xs" href="#Representing-“ε”" title="Representing-“ε”"><i class="fa fa-link"></i></a>Representing “ε”</h2><blockquote>
<p><em>ε arcs/states are essential, among other, to represent back-off LM models</em></p>
</blockquote><pre class="graphviz"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="493pt" height="136pt" viewBox="0.00 0.00 492.67 135.61" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 131.6053)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-131.6053 488.6684,-131.6053 488.6684,4 -4,4"></polygon>
<!-- n0 -->
<g id="node1" class="node">
<title>n0</title>
<ellipse fill="none" stroke="#000000" stroke-width="2" cx="18" cy="-27.8053" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="18" y="-23.6053" font-family="Times,serif" font-size="14.00" fill="#000000">0</text>
</g>
<!-- n1 -->
<g id="node2" class="node">
<title>n1</title>
<ellipse fill="none" stroke="#000000" cx="107.1052" cy="-27.8053" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="107.1052" y="-23.6053" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- n0&#45;&gt;n1 -->
<g id="edge1" class="edge">
<title>n0-&gt;n1</title>
<path fill="none" stroke="#000000" d="M36.0318,-27.8053C48.3509,-27.8053 64.9235,-27.8053 78.9667,-27.8053"></path>
<polygon fill="#000000" stroke="#000000" points="79.1003,-31.3054 89.1003,-27.8053 79.1002,-24.3054 79.1003,-31.3054"></polygon>
<text text-anchor="middle" x="62.5526" y="-32.0053" font-family="Times,serif" font-size="14.00" fill="#000000">a/1</text>
</g>
<!-- n1&#45;&gt;n1 -->
<g id="edge2" class="edge">
<title>n1-&gt;n1</title>
<path fill="none" stroke="#000000" d="M99.4373,-44.0956C97.5883,-54.1945 100.1443,-63.8053 107.1052,-63.8053 111.5646,-63.8053 114.2161,-59.861 115.0598,-54.371"></path>
<polygon fill="#000000" stroke="#000000" points="118.5508,-53.994 114.7731,-44.0956 111.5535,-54.1894 118.5508,-53.994"></polygon>
<text text-anchor="middle" x="107.1052" y="-68.0053" font-family="Times,serif" font-size="14.00" fill="#000000">a/ν1 ⊗ δ1</text>
</g>
<!-- n2 -->
<g id="node3" class="node">
<title>n2</title>
<ellipse fill="none" stroke="#000000" cx="289.0302" cy="-74.8053" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="289.0302" y="-70.6053" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- n1&#45;&gt;n2 -->
<g id="edge3" class="edge">
<title>n1-&gt;n2</title>
<path fill="none" stroke="#000000" d="M118.1003,-42.5574C124.5115,-49.9805 133.2653,-58.332 143.1052,-62.8053 181.027,-80.045 230.1949,-80.1305 260.6715,-77.9594"></path>
<polygon fill="#000000" stroke="#000000" points="261.3295,-81.4163 270.9986,-77.0851 260.7389,-74.4413 261.3295,-81.4163"></polygon>
<text text-anchor="middle" x="189.9611" y="-83.0053" font-family="Times,serif" font-size="14.00" fill="#000000">b/x ⊕ ν1 ⊗ δ2</text>
</g>
<!-- n3 -->
<g id="node4" class="node">
<title>n3</title>
<ellipse fill="none" stroke="#000000" cx="450.4552" cy="-27.8053" rx="18" ry="18"></ellipse>
<ellipse fill="none" stroke="#000000" cx="450.4552" cy="-27.8053" rx="22" ry="22"></ellipse>
<text text-anchor="middle" x="450.4552" y="-23.6053" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- n1&#45;&gt;n3 -->
<g id="edge4" class="edge">
<title>n1-&gt;n3</title>
<path fill="none" stroke="#000000" d="M125.4111,-26.5913C131.0801,-26.2684 137.3486,-25.9651 143.1052,-25.8053 261.8817,-22.5085 291.67,-22.8376 410.4552,-25.8053 413.0097,-25.8692 415.6551,-25.9559 418.3126,-26.0576"></path>
<polygon fill="#000000" stroke="#000000" points="418.3107,-29.5609 428.4561,-26.5076 418.621,-22.5677 418.3107,-29.5609"></polygon>
<text text-anchor="middle" x="289.0302" y="-28.0053" font-family="Times,serif" font-size="14.00" fill="#000000">c/ν1 ⊗ δ3</text>
</g>
<!-- n2&#45;&gt;n1 -->
<g id="edge5" class="edge">
<title>n2-&gt;n1</title>
<path fill="none" stroke="#000000" d="M274.8695,-63.4187C264.8514,-56.0136 250.7689,-46.8617 236.817,-42.0053 203.3457,-30.3545 162.3417,-27.6405 135.5119,-27.2916"></path>
<polygon fill="#000000" stroke="#000000" points="135.2954,-23.7912 125.2862,-27.2649 135.277,-30.7911 135.2954,-23.7912"></polygon>
<text text-anchor="middle" x="189.9611" y="-46.0053" font-family="Times,serif" font-size="14.00" fill="#000000">a/ν2 ⊗ δ1</text>
</g>
<!-- n2&#45;&gt;n2 -->
<g id="edge6" class="edge">
<title>n2-&gt;n2</title>
<path fill="none" stroke="#000000" d="M275.7751,-87.3501C269.3267,-98.675 273.745,-110.8053 289.0302,-110.8053 299.897,-110.8053 305.2714,-104.6743 305.1533,-97.0604"></path>
<polygon fill="#000000" stroke="#000000" points="308.4746,-95.9491 302.2853,-87.3501 301.7613,-97.932 308.4746,-95.9491"></polygon>
<text text-anchor="middle" x="289.0302" y="-115.0053" font-family="Times,serif" font-size="14.00" fill="#000000">b/ν2 ⊗ δ2</text>
</g>
<!-- n2&#45;&gt;n3 -->
<g id="edge7" class="edge">
<title>n2-&gt;n3</title>
<path fill="none" stroke="#000000" d="M307.1695,-76.3627C331.68,-77.737 376.2426,-77.6211 410.4552,-62.8053 416.6789,-60.1101 422.6262,-56.0775 427.9426,-51.6975"></path>
<polygon fill="#000000" stroke="#000000" points="430.6489,-53.9697 435.7269,-44.6711 425.9585,-48.7735 430.6489,-53.9697"></polygon>
<text text-anchor="middle" x="375.8493" y="-80.0053" font-family="Times,serif" font-size="14.00" fill="#000000">c/ν2 ⊗ δ3</text>
</g>
<!-- n3&#45;&gt;n1 -->
<g id="edge8" class="edge">
<title>n3-&gt;n1</title>
<path fill="none" stroke="#000000" d="M429.0476,-22.0958C403.9267,-15.7162 360.9129,-5.7867 323.2434,-2.0053 255.2734,4.8178 175.527,-10.8586 134.5246,-20.6621"></path>
<polygon fill="#000000" stroke="#000000" points="133.6061,-17.2836 124.731,-23.07 135.2775,-24.0812 133.6061,-17.2836"></polygon>
<text text-anchor="middle" x="289.0302" y="-6.0053" font-family="Times,serif" font-size="14.00" fill="#000000">a/ν3 ⊗ δ1</text>
</g>
<!-- n3&#45;&gt;n2 -->
<g id="edge9" class="edge">
<title>n3-&gt;n2</title>
<path fill="none" stroke="#000000" d="M428.045,-27.9324C405.4955,-28.6968 370.0318,-31.6565 341.2434,-42.0053 330.8169,-45.7534 320.2867,-51.8322 311.4408,-57.7444"></path>
<polygon fill="#000000" stroke="#000000" points="309.3998,-54.9008 303.2227,-63.5086 313.4195,-60.6317 309.3998,-54.9008"></polygon>
<text text-anchor="middle" x="375.8493" y="-46.0053" font-family="Times,serif" font-size="14.00" fill="#000000">b/ν3 ⊗ δ2</text>
</g>
<!-- n3&#45;&gt;n3 -->
<g id="edge10" class="edge">
<title>n3-&gt;n3</title>
<path fill="none" stroke="#000000" d="M437.5592,-45.9056C434.4495,-57.1266 438.7482,-67.8053 450.4552,-67.8053 458.5038,-67.8053 463.0508,-62.758 464.0961,-55.9571"></path>
<polygon fill="#000000" stroke="#000000" points="467.5808,-55.6196 463.3512,-45.9056 460.6,-56.137 467.5808,-55.6196"></polygon>
<text text-anchor="middle" x="450.4552" y="-72.0053" font-family="Times,serif" font-size="14.00" fill="#000000">c/ν3 ⊗ δ3</text>
</g>
</g>
</svg>
</pre><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi>&amp;#x03BD;</mi><mn>1</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>1</mn></mtd><mtd><mi>x</mi><mo>&amp;#x2295;</mo><msub><mi>&amp;#x03BD;</mi><mn>1</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>2</mn></mtd><mtd><msub><mi>&amp;#x03BD;</mi><mn>1</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>3</mn></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03BD;</mi><mn>2</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>1</mn></mtd><mtd><msub><mi>&amp;#x03BD;</mi><mn>2</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>2</mn></mtd><mtd><msub><mi>&amp;#x03BD;</mi><mn>2</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>3</mn></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03BD;</mi><mn>3</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>1</mn></mtd><mtd><msub><mi>&amp;#x03BD;</mi><mn>2</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>2</mn></mtd><mtd><msub><mi>&amp;#x03BD;</mi><mn>3</mn></msub><mo>&amp;#x2297;</mo><mi>&amp;#x03B4;</mi><mn>3</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-452" style="width: 20.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.806em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.308em, 1016.75em, 6.509em, -999.997em); top: -4.659em; left: 0em;"><span class="mrow" id="MathJax-Span-453"><span class="texatom" id="MathJax-Span-454"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span class="mo" id="MathJax-Span-457" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-458" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-459" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-460" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 13.732em; height: 0px;"><span style="position: absolute; clip: rect(2.462em, 1003.13em, 6.509em, -999.997em); top: -4.711em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.23em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1003.13em, 4.306em, -999.997em); top: -5.377em; left: 50%; margin-left: -1.586em;"><span class="mtd" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="msubsup" id="MathJax-Span-463"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-464" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-465" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-466" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-467" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-468" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.13em, 4.306em, -999.997em); top: -3.942em; left: 50%; margin-left: -1.586em;"><span class="mtd" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="msubsup" id="MathJax-Span-489"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-490" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-491" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-492" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-493" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-494" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.13em, 4.306em, -999.997em); top: -2.508em; left: 50%; margin-left: -1.586em;"><span class="mtd" id="MathJax-Span-511"><span class="mrow" id="MathJax-Span-512"><span class="msubsup" id="MathJax-Span-513"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-514" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-515" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-516" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-517" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-518" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span><span style="position: absolute; clip: rect(2.462em, 1005.02em, 6.509em, -999.997em); top: -4.711em; left: 4.357em;"><span style="display: inline-block; position: relative; width: 5.023em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1005.02em, 4.306em, -999.997em); top: -5.377em; left: 50%; margin-left: -2.508em;"><span class="mtd" id="MathJax-Span-469"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-472" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊕</span><span class="msubsup" id="MathJax-Span-473" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-474" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-475" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-476" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-477" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-478" style="font-family: STIXGeneral-Regular;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.18em, 4.306em, -999.997em); top: -3.942em; left: 50%; margin-left: -1.586em;"><span class="mtd" id="MathJax-Span-495"><span class="mrow" id="MathJax-Span-496"><span class="msubsup" id="MathJax-Span-497"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-498" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-499" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-500" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-501" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-502" style="font-family: STIXGeneral-Regular;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.18em, 4.306em, -999.997em); top: -2.508em; left: 50%; margin-left: -1.586em;"><span class="mtd" id="MathJax-Span-519"><span class="mrow" id="MathJax-Span-520"><span class="msubsup" id="MathJax-Span-521"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-522" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-523" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-524" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-525" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-526" style="font-family: STIXGeneral-Regular;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span><span style="position: absolute; clip: rect(2.462em, 1003.13em, 6.509em, -999.997em); top: -4.711em; left: 10.505em;"><span style="display: inline-block; position: relative; width: 3.23em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1003.13em, 4.306em, -999.997em); top: -5.377em; left: 50%; margin-left: -1.586em;"><span class="mtd" id="MathJax-Span-479"><span class="mrow" id="MathJax-Span-480"><span class="msubsup" id="MathJax-Span-481"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-482" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-483" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-484" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-485" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-486" style="font-family: STIXGeneral-Regular;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.13em, 4.306em, -999.997em); top: -3.942em; left: 50%; margin-left: -1.586em;"><span class="mtd" id="MathJax-Span-503"><span class="mrow" id="MathJax-Span-504"><span class="msubsup" id="MathJax-Span-505"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-506" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-507" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-508" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-509" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-510" style="font-family: STIXGeneral-Regular;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.13em, 4.306em, -999.997em); top: -2.508em; left: 50%; margin-left: -1.586em;"><span class="mtd" id="MathJax-Span-527"><span class="mrow" id="MathJax-Span-528"><span class="msubsup" id="MathJax-Span-529"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-530" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-531" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-532" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="mi" id="MathJax-Span-533" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">δ</span><span class="mn" id="MathJax-Span-534" style="font-family: STIXGeneral-Regular;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span></span></span><span class="mo" id="MathJax-Span-535" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.664em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.122em; border-left: 0px solid; width: 0px; height: 4.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>ν</mi><mn>1</mn></msub><mo>⊗</mo><mi>δ</mi><mn>1</mn></mtd><mtd><mi>x</mi><mo>⊕</mo><msub><mi>ν</mi><mn>1</mn></msub><mo>⊗</mo><mi>δ</mi><mn>2</mn></mtd><mtd><msub><mi>ν</mi><mn>1</mn></msub><mo>⊗</mo><mi>δ</mi><mn>3</mn></mtd></mtr><mtr><mtd><msub><mi>ν</mi><mn>2</mn></msub><mo>⊗</mo><mi>δ</mi><mn>1</mn></mtd><mtd><msub><mi>ν</mi><mn>2</mn></msub><mo>⊗</mo><mi>δ</mi><mn>2</mn></mtd><mtd><msub><mi>ν</mi><mn>2</mn></msub><mo>⊗</mo><mi>δ</mi><mn>3</mn></mtd></mtr><mtr><mtd><msub><mi>ν</mi><mn>3</mn></msub><mo>⊗</mo><mi>δ</mi><mn>1</mn></mtd><mtd><msub><mi>ν</mi><mn>2</mn></msub><mo>⊗</mo><mi>δ</mi><mn>2</mn></mtd><mtd><msub><mi>ν</mi><mn>3</mn></msub><mo>⊗</mo><mi>δ</mi><mn>3</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">
\mathbf{T} = \begin{bmatrix}
    \nu_1 \otimes \delta1 & x \oplus \nu_1 \otimes \delta2 & \nu_1 \otimes \delta3 \\
    \nu_2 \otimes \delta1 & \nu_2 \otimes \delta2 & \nu_2 \otimes \delta3 \\
    \nu_3 \otimes \delta1 & \nu_2 \otimes \delta2 & \nu_3 \otimes \delta3 
\end{bmatrix}
</script></span></p><p>The matrix is highly redundant and can be factorized as:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>S</mi></mrow><mo>+</mo><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03BD;</mi><msup><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B4;</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mi>x</mi></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mn>0</mn><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><mrow><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi>&amp;#x03BD;</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03BD;</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03BD;</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><msup><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi>&amp;#x03B4;</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03B4;</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>&amp;#x03B4;</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup></mrow><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03F5;</mi><mtext>-state</mtext></mrow></munder></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-536" style="width: 21.058em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.267em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.205em, 1017.27em, 8.302em, -999.997em); top: -4.762em; left: 0em;"><span class="mrow" id="MathJax-Span-537"><span class="texatom" id="MathJax-Span-538"><span class="mrow" id="MathJax-Span-539"><span class="mi" id="MathJax-Span-540" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span class="mo" id="MathJax-Span-541" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="texatom" id="MathJax-Span-542" style="padding-left: 0.31em;"><span class="mrow" id="MathJax-Span-543"><span class="mi" id="MathJax-Span-544" style="font-family: STIXGeneral; font-weight: bold;">S</span></span></span><span class="mo" id="MathJax-Span-545" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mi" id="MathJax-Span-546" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.259em;">ν</span><span class="msubsup" id="MathJax-Span-547"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-548" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">δ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-549" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-550" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-551" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-552" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.254em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.022em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-553" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 3.742em; height: 0px;"><span style="position: absolute; clip: rect(2.41em, 1000.46em, 6.611em, -999.997em); top: -4.864em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -5.428em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-554"><span class="mrow" id="MathJax-Span-555"><span class="texatom" id="MathJax-Span-556"><span class="mrow" id="MathJax-Span-557"><span class="munderover" id="MathJax-Span-558"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-559" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-560" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -3.891em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="texatom" id="MathJax-Span-573"><span class="mrow" id="MathJax-Span-574"><span class="munderover" id="MathJax-Span-575"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-576" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-577" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-592"><span class="mrow" id="MathJax-Span-593"><span class="texatom" id="MathJax-Span-594"><span class="mrow" id="MathJax-Span-595"><span class="munderover" id="MathJax-Span-596"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-597" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-598" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.869em;"></span></span><span style="position: absolute; clip: rect(2.41em, 1000.46em, 6.201em, -999.997em); top: -4.454em; left: 1.642em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -5.428em; left: 50%; margin-left: -0.202em;"><span class="mtd" id="MathJax-Span-561"><span class="mrow" id="MathJax-Span-562"><span class="mi" id="MathJax-Span-563" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -3.891em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-578"><span class="mrow" id="MathJax-Span-579"><span class="texatom" id="MathJax-Span-580"><span class="mrow" id="MathJax-Span-581"><span class="munderover" id="MathJax-Span-582"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-583" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-584" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-599"><span class="mrow" id="MathJax-Span-600"><span class="texatom" id="MathJax-Span-601"><span class="mrow" id="MathJax-Span-602"><span class="munderover" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-604" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-605" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.46em;"></span></span><span style="position: absolute; clip: rect(2.41em, 1000.46em, 6.611em, -999.997em); top: -4.864em; left: 3.23em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -5.428em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-564"><span class="mrow" id="MathJax-Span-565"><span class="texatom" id="MathJax-Span-566"><span class="mrow" id="MathJax-Span-567"><span class="munderover" id="MathJax-Span-568"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-569" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-570" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -3.891em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="texatom" id="MathJax-Span-587"><span class="mrow" id="MathJax-Span-588"><span class="munderover" id="MathJax-Span-589"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-590" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-591" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1000.46em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-606"><span class="mrow" id="MathJax-Span-607"><span class="texatom" id="MathJax-Span-608"><span class="mrow" id="MathJax-Span-609"><span class="munderover" id="MathJax-Span-610"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-611" style="font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.23em, 1000.31em, 3.589em, -999.997em); top: -4.249em; left: 0.105em;"><span class="mo" id="MathJax-Span-612" style="font-family: STIXGeneral-Regular;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.869em;"></span></span></span></span><span class="mo" id="MathJax-Span-613" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.254em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.79em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.022em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-614" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="munderover" id="MathJax-Span-615" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 4.972em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1004.97em, 8.763em, -999.997em); top: -5.991em; left: 0em;"><span class="texatom" id="MathJax-Span-616"><span class="mrow" id="MathJax-Span-617"><span class="munderover" id="MathJax-Span-618"><span style="display: inline-block; position: relative; width: 4.972em; height: 0px;"><span style="position: absolute; clip: rect(2.513em, 1004.97em, 6.919em, -999.997em); top: -5.069em; left: 0.003em;"><span class="mrow" id="MathJax-Span-619"><span class="mrow" id="MathJax-Span-620"><span class="mo" id="MathJax-Span-621" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-622" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(2.513em, 1000.92em, 6.304em, -999.997em); top: -4.506em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.92em, 4.306em, -999.997em); top: -5.377em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-623"><span class="mrow" id="MathJax-Span-624"><span class="msubsup" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-626" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-627" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.92em, 4.306em, -999.997em); top: -3.942em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-628"><span class="mrow" id="MathJax-Span-629"><span class="msubsup" id="MathJax-Span-630"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-631" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-632" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.92em, 4.306em, -999.997em); top: -2.508em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-633"><span class="mrow" id="MathJax-Span-634"><span class="msubsup" id="MathJax-Span-635"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-636" style="font-family: STIXGeneral-Italic;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-637" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.511em;"></span></span></span></span><span class="mo" id="MathJax-Span-638" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="msubsup" id="MathJax-Span-639" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 2.666em; height: 0px;"><span style="position: absolute; clip: rect(2.564em, 1002.05em, 6.765em, -999.997em); top: -4.915em; left: 0em;"><span class="mrow" id="MathJax-Span-640"><span class="mo" id="MathJax-Span-641" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-642" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(2.513em, 1000.87em, 6.509em, -999.997em); top: -4.711em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.87em, 4.306em, -999.997em); top: -5.377em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-643"><span class="mrow" id="MathJax-Span-644"><span class="msubsup" id="MathJax-Span-645"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-646" style="font-family: STIXGeneral-Italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-647" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.87em, 4.306em, -999.997em); top: -3.942em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-648"><span class="mrow" id="MathJax-Span-649"><span class="msubsup" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-651" style="font-family: STIXGeneral-Italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-652" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.87em, 4.306em, -999.997em); top: -2.508em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-653"><span class="mrow" id="MathJax-Span-654"><span class="msubsup" id="MathJax-Span-655"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-656" style="font-family: STIXGeneral-Italic;">δ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-657" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span></span></span><span class="mo" id="MathJax-Span-658" style="vertical-align: 2.205em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.407em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.354em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.381em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.921em;"></span></span><span style="position: absolute; top: -5.94em; left: 2.103em;"><span class="mi" id="MathJax-Span-659" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.074em;"></span></span><span style="position: absolute; clip: rect(3.64em, 1004.97em, 4.664em, -999.997em); top: -1.893em; left: 0em;"><span class="mo" id="MathJax-Span-660" style=""><span style="display: inline-block; position: relative; width: 4.972em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 0.003em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 4.05em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 1.591em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 0.72em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 1.13em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 3.23em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 3.64em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.996em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1001.85em, 4.255em, -999.997em); top: -0.715em; left: 1.591em;"><span class="texatom" id="MathJax-Span-661"><span class="mrow" id="MathJax-Span-662"><span class="mi" id="MathJax-Span-663" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϵ</span><span class="mtext" id="MathJax-Span-664" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">-state</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.767em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.184em; border-left: 0px solid; width: 0px; height: 7.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">S</mi></mrow><mo>+</mo><mi mathvariant="bold-italic">ν</mi><msup><mi mathvariant="bold-italic">δ</mi><mi mathvariant="normal">⊤</mi></msup><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mi>x</mi></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mn>0</mn><mo stretchy="false">¯</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>+</mo><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>ν</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>ν</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>ν</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><msup><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>δ</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>δ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>δ</mi><mn>3</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mi mathvariant="normal">⊤</mi></msup></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>ϵ</mi><mtext>-state</mtext></mrow></munder></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">
\mathbf{T} = \mathbf{S} + \boldsymbol{\nu} \boldsymbol{\delta}^\top = \begin{bmatrix}
   \bar{0} & x & \bar{0} \\
   \bar{0} & \bar{0} & \bar{0} \\
   \bar{0} & \bar{0} & \bar{0} \\
\end{bmatrix} + \underbrace{\begin{bmatrix} \nu_1 \\ \nu_2 \\ \nu_3 \end{bmatrix} \begin{bmatrix} \delta_1 \\ \delta_2 \\ \delta_3 \end{bmatrix}^\top}_{\epsilon \text{-state}}
</script></span></p><pre class="graphviz"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="452pt" height="100pt" viewBox="0.00 0.00 452.13 99.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 95.8)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-95.8 448.1312,-95.8 448.1312,4 -4,4"></polygon>
<!-- n0 -->
<g id="node1" class="node">
<title>n0</title>
<ellipse fill="none" stroke="#000000" stroke-width="2" cx="18" cy="-18" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="18" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#000000">0</text>
</g>
<!-- n1 -->
<g id="node2" class="node">
<title>n1</title>
<ellipse fill="none" stroke="#000000" cx="107.1052" cy="-18" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="107.1052" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- n0&#45;&gt;n1 -->
<g id="edge1" class="edge">
<title>n0-&gt;n1</title>
<path fill="none" stroke="#000000" d="M36.0318,-18C48.3509,-18 64.9235,-18 78.9667,-18"></path>
<polygon fill="#000000" stroke="#000000" points="79.1003,-21.5001 89.1003,-18 79.1002,-14.5001 79.1003,-21.5001"></polygon>
<text text-anchor="middle" x="62.5526" y="-22.2" font-family="Times,serif" font-size="14.00" fill="#000000">a/1</text>
</g>
<!-- n2 -->
<g id="node3" class="node">
<title>n2</title>
<ellipse fill="none" stroke="#000000" cx="197.8517" cy="-71" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="197.8517" y="-66.8" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- n1&#45;&gt;n2 -->
<g id="edge2" class="edge">
<title>n1-&gt;n2</title>
<path fill="none" stroke="#000000" d="M122.912,-27.2319C136.8353,-35.3637 157.3377,-47.338 173.3796,-56.7072"></path>
<polygon fill="#000000" stroke="#000000" points="171.8257,-59.8529 182.226,-61.8739 175.356,-53.8083 171.8257,-59.8529"></polygon>
<text text-anchor="middle" x="152.0505" y="-54.2" font-family="Times,serif" font-size="14.00" fill="#000000">b/x</text>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<ellipse fill="#d3d3d3" stroke="#000000" cx="308.4194" cy="-34" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="308.4194" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- n1&#45;&gt;n5 -->
<g id="edge3" class="edge">
<title>n1-&gt;n5</title>
<path fill="none" stroke="#000000" d="M125.3256,-19.4481C160.5843,-22.2504 238.3582,-28.4317 280.2989,-31.765"></path>
<polygon fill="#000000" stroke="#000000" points="280.1394,-35.2633 290.3853,-32.5667 280.694,-28.2853 280.1394,-35.2633"></polygon>
<text text-anchor="middle" x="197.8517" y="-31.2" font-family="Times,serif" font-size="14.00" fill="#000000">ε/ν1</text>
</g>
<!-- n2&#45;&gt;n5 -->
<g id="edge4" class="edge">
<title>n2-&gt;n5</title>
<path fill="none" stroke="#000000" d="M215.7919,-74.0649C231.3943,-75.9196 254.2815,-76.6486 272.4194,-69 279.219,-66.1327 285.4583,-61.3343 290.7642,-56.1956"></path>
<polygon fill="#000000" stroke="#000000" points="293.5751,-58.3129 297.8268,-48.6086 288.4514,-53.5433 293.5751,-58.3129"></polygon>
<text text-anchor="middle" x="253.5635" y="-79.2" font-family="Times,serif" font-size="14.00" fill="#000000">ε/ν2</text>
</g>
<!-- n3 -->
<g id="node4" class="node">
<title>n3</title>
<ellipse fill="none" stroke="#000000" cx="422.1312" cy="-34" rx="18" ry="18"></ellipse>
<ellipse fill="none" stroke="#000000" cx="422.1312" cy="-34" rx="22" ry="22"></ellipse>
<text text-anchor="middle" x="422.1312" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">4</text>
</g>
<!-- n3&#45;&gt;n5 -->
<g id="edge5" class="edge">
<title>n3-&gt;n5</title>
<path fill="none" stroke="#000000" d="M402.8068,-22.8311C396.4336,-19.7241 389.1707,-16.7718 382.1312,-15.2 365.7732,-11.5475 360.6973,-11.2056 344.4194,-15.2 340.4498,-16.1741 336.4321,-17.671 332.5916,-19.404"></path>
<polygon fill="#000000" stroke="#000000" points="330.8471,-16.3649 323.5382,-24.035 334.035,-22.597 330.8471,-16.3649"></polygon>
<text text-anchor="middle" x="363.2753" y="-20.2" font-family="Times,serif" font-size="14.00" fill="#000000">ε/ν3</text>
</g>
<!-- n5&#45;&gt;n1 -->
<g id="edge6" class="edge">
<title>n5-&gt;n1</title>
<path fill="none" stroke="#000000" d="M291.9317,-26.647C273.8853,-19.0337 243.8925,-7.6429 216.7076,-3.2 200.1663,-.4966 195.6703,-1.5014 178.9958,-3.2 164.1913,-4.7081 147.9335,-7.9201 134.6291,-10.9676"></path>
<polygon fill="#000000" stroke="#000000" points="133.5921,-7.6167 124.6766,-13.3407 135.2157,-14.4258 133.5921,-7.6167"></polygon>
<text text-anchor="middle" x="197.8517" y="-8.2" font-family="Times,serif" font-size="14.00" fill="#000000">a/δ1</text>
</g>
<!-- n5&#45;&gt;n2 -->
<g id="edge7" class="edge">
<title>n5-&gt;n2</title>
<path fill="none" stroke="#000000" d="M290.3383,-35.6314C275.0951,-37.4382 252.9181,-41.0916 234.7076,-48.2 230.1299,-49.9869 225.489,-52.3461 221.1152,-54.8692"></path>
<polygon fill="#000000" stroke="#000000" points="219.2656,-51.8978 212.6182,-60.1477 222.9595,-57.8438 219.2656,-51.8978"></polygon>
<text text-anchor="middle" x="253.5635" y="-53.2" font-family="Times,serif" font-size="14.00" fill="#000000">b/δ2</text>
</g>
<!-- n5&#45;&gt;n3 -->
<g id="edge8" class="edge">
<title>n5-&gt;n3</title>
<path fill="none" stroke="#000000" d="M326.4374,-34C343.3958,-34 369.1846,-34 389.7191,-34"></path>
<polygon fill="#000000" stroke="#000000" points="389.9037,-37.5001 399.9037,-34 389.9037,-30.5001 389.9037,-37.5001"></polygon>
<text text-anchor="middle" x="363.2753" y="-38.2" font-family="Times,serif" font-size="14.00" fill="#000000">c/δ3</text>
</g>
</g>
</svg>
</pre><p>In addition to compress the representation of the FSA, ε-states can be used to accelerate the inference:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow></mtd><mtd><mi></mi><mo>=</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>S</mi></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mo>+</mo><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B4;</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03BD;</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-665" style="width: 10.812em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.865em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1008.66em, 2.666em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-666"><span class="mtable" id="MathJax-Span-667" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 8.558em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.69em, 4.255em, -999.997em); top: -3.993em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1001.69em, 4.152em, -999.997em); top: -3.891em; right: 0em;"><span class="mtd" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="msubsup" id="MathJax-Span-670"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-671"><span class="mrow" id="MathJax-Span-672"><span class="mi" id="MathJax-Span-673" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.669em;"><span class="mi" id="MathJax-Span-674" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-675"><span class="mrow" id="MathJax-Span-676"><span class="mi" id="MathJax-Span-677" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1006.76em, 4.408em, -999.997em); top: -3.993em; left: 1.744em;"><span style="display: inline-block; position: relative; width: 6.816em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1006.76em, 4.306em, -999.997em); top: -3.891em; left: 0em;"><span class="mtd" id="MathJax-Span-678"><span class="mrow" id="MathJax-Span-679"><span class="mi" id="MathJax-Span-680"></span><span class="mo" id="MathJax-Span-681" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-682" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-683"><span class="mrow" id="MathJax-Span-684"><span class="mi" id="MathJax-Span-685" style="font-family: STIXGeneral; font-weight: bold;">S</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.566em;"><span class="mi" id="MathJax-Span-686" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-687"><span class="mrow" id="MathJax-Span-688"><span class="mi" id="MathJax-Span-689" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span class="mo" id="MathJax-Span-690" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mi" id="MathJax-Span-691" style="font-family: STIXGeneral; font-style: italic; font-weight: bold; padding-left: 0.259em;">δ</span><span class="mo" id="MathJax-Span-692" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-693"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-694" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ν</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.464em;"><span class="mi" id="MathJax-Span-695" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-696"><span class="mrow" id="MathJax-Span-697"><span class="mi" id="MathJax-Span-698" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span class="mo" id="MathJax-Span-699" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow></mtd><mtd><mi></mi><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">S</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>+</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">(</mo><msup><mi mathvariant="bold-italic">ν</mi><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">
\begin{align}
    \mathbf{T}^\top \mathbf{v} &= \mathbf{S}^\top \mathbf{v} + \boldsymbol{\delta} ( \boldsymbol{\nu}^\top \mathbf{v})
\end{align}
</script></span></p><blockquote>
<p><mark><em>ε-states can be preserved during the inference (even on GPU) !!</em></mark></p>
</blockquote><h2 id="Building-the-decoding-graph"><a class="anchor hidden-xs" href="#Building-the-decoding-graph" title="Building-the-decoding-graph"><i class="fa fa-link"></i></a>Building the decoding graph</h2><p>Not composing,  <mark><strong>replacing</strong></mark> !</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-700" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.72em, 2.41em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-701"><span class="mi" id="MathJax-Span-702" style="font-family: STIXGeneral-Italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">G</script></span>:<br>
<img src="https://codimd.math.cnrs.fr/uploads/upload_b9908c0ede1739f6da351f831945c950.png" alt="" class="md-image md-image"></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-703" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.62em, 2.41em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">L</script></span>:</p><ul>
<li>bon: <img src="https://codimd.math.cnrs.fr/uploads/upload_b5b135b7fdecc103a7ac9f9e66114853.png" alt="" class="md-image md-image"></li>
<li>jour: <img src="https://codimd.math.cnrs.fr/uploads/upload_989b46bec9d70943202dc27485312e66.png" alt="" class="md-image md-image"></li>
<li>soir: <img src="https://codimd.math.cnrs.fr/uploads/upload_cb25d0f7dad450b048002ce8395ea84a.png" alt="" class="md-image md-image"></li>
</ul><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mo>=</mo><mtext>replace</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>G</mi><mo>,</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-706" style="width: 8.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.277em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1007.23em, 2.615em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-707"><span class="mi" id="MathJax-Span-708" style="font-family: STIXGeneral-Italic;">D</span><span class="mo" id="MathJax-Span-709" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mtext" id="MathJax-Span-710" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">replace</span><span class="mo" id="MathJax-Span-711" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-712" style="font-family: STIXGeneral-Italic;">G</span><span class="mo" id="MathJax-Span-713" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-714" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-715" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo>=</mo><mtext>replace</mtext><mo stretchy="false">(</mo><mi>G</mi><mo>,</mo><mi>L</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">D = \text{replace}(G, L)</script></span>:<br>
<img src="https://codimd.math.cnrs.fr/uploads/upload_404d81e9fb18068a8b34d2fe54d1c148.png" alt="" class="md-image md-image"></p><ul>
<li>cons:
<ul>
<li>much bigger graph: <em>determinization is ineffective</em></li>
</ul>
</li>
<li>pros:
<ul>
<li>no need to globally renormalize (a.k.a. weight-push)</li>
<li>dynamic evaluation</li>
</ul>
</li>
</ul><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>D</mi></msub><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>P</mi></msub><mo>+</mo><msub><mi mathvariant=&quot;bold-italic&quot;>A</mi><mi>P</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>G</mi></msub><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>&amp;#x03A9;</mi></mrow><mi>P</mi></msub><mo>=</mo><mover><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><mover><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mn>1</mn></msub></mtd><mtd /><mtd /></mtr><mtr><mtd /><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mn>2</mn></msub></mtd><mtd /></mtr><mtr><mtd /><mtd /><mtd><mo>&amp;#x22F1;</mo></mtd></mtr></mtable><mo>]</mo></mrow><mo>&amp;#x23DE;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mo>&amp;#x00D7;</mo><mi>Q</mi></mrow></mover><mo>+</mo><mover><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><mover><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B1;</mi><mn>1</mn></msub></mtd><mtd /><mtd /></mtr><mtr><mtd /><mtd><msub><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B1;</mi><mn>2</mn></msub></mtd><mtd /></mtr><mtr><mtd /><mtd /><mtd><mo>&amp;#x22F1;</mo></mtd></mtr></mtable><mo>]</mo></mrow><mo>&amp;#x23DE;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mo>&amp;#x00D7;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mover><mover><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><mover><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>G</mi></msub><mo>&amp;#x23DE;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>&amp;#x00D7;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mover><mover><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><mover><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi><mn>1</mn></msub></mtd><mtd /><mtd /></mtr><mtr><mtd /><mtd><msub><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi><mn>2</mn></msub></mtd><mtd /></mtr><mtr><mtd /><mtd /><mtd><mo>&amp;#x22F1;</mo></mtd></mtr></mtable><mo>]</mo></mrow><mo>&amp;#x23DE;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>&amp;#x00D7;</mo><mi>Q</mi></mrow></mover></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-716" style="width: 39.91em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.687em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-1.893em, 1032.69em, 4.203em, -999.997em); top: -2.252em; left: 0em;"><span class="mrow" id="MathJax-Span-717"><span class="msubsup" id="MathJax-Span-718"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-719"><span class="mrow" id="MathJax-Span-720"><span class="mi" id="MathJax-Span-721" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-722" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-723" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-724" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="mi" id="MathJax-Span-727" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-728" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-729" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="msubsup" id="MathJax-Span-730" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-731" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-732" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-733"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-734"><span class="mrow" id="MathJax-Span-735"><span class="mi" id="MathJax-Span-736" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-737" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-738"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-739"><span class="mrow" id="MathJax-Span-740"><span class="mi" id="MathJax-Span-741" style="font-family: STIXGeneral; font-weight: bold;">Ω</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-742" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-743" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="munderover" id="MathJax-Span-744" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 6.611em; height: 0px;"><span style="position: absolute; clip: rect(2.666em, 1006.61em, 7.892em, -999.997em); top: -5.94em; left: 0em;"><span class="texatom" id="MathJax-Span-745"><span class="mrow" id="MathJax-Span-746"><span class="munderover" id="MathJax-Span-747"><span style="display: inline-block; position: relative; width: 6.611em; height: 0px;"><span style="position: absolute; clip: rect(2.666em, 1006.51em, 7.072em, -999.997em); top: -5.12em; left: 0.003em;"><span class="mrow" id="MathJax-Span-748"><span class="mo" id="MathJax-Span-749" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.202em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.508em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.739em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.971em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-750" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 5.382em; height: 0px;"><span style="position: absolute; clip: rect(2.462em, 1001.08em, 6.56em, -999.997em); top: -4.813em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.08em, 4.306em, -999.997em); top: -5.479em; left: 50%; margin-left: -0.561em;"><span class="mtd" id="MathJax-Span-751"><span class="mrow" id="MathJax-Span-752"><span class="msubsup" id="MathJax-Span-753"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-754"><span class="mrow" id="MathJax-Span-755"><span class="mi" id="MathJax-Span-756" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mn" id="MathJax-Span-757" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-762"><span class="mrow" id="MathJax-Span-763"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-773"><span class="mrow" id="MathJax-Span-774"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.818em;"></span></span><span style="position: absolute; clip: rect(2.462em, 1001.08em, 5.843em, -999.997em); top: -4.096em; left: 2.205em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -5.479em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-758"><span class="mrow" id="MathJax-Span-759"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1001.08em, 4.306em, -999.997em); top: -4.045em; left: 50%; margin-left: -0.561em;"><span class="mtd" id="MathJax-Span-764"><span class="mrow" id="MathJax-Span-765"><span class="msubsup" id="MathJax-Span-766"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-767"><span class="mrow" id="MathJax-Span-768"><span class="mi" id="MathJax-Span-769" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mn" id="MathJax-Span-770" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-775"><span class="mrow" id="MathJax-Span-776"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.101em;"></span></span><span style="position: absolute; clip: rect(2.513em, 1000.72em, 5.945em, -999.997em); top: -4.147em; left: 4.46em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -5.479em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-760"><span class="mrow" id="MathJax-Span-761"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-771"><span class="mrow" id="MathJax-Span-772"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1000.72em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-777"><span class="mrow" id="MathJax-Span-778"><span class="mo" id="MathJax-Span-779" style="font-family: STIXGeneral-Regular;">⋱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-780" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.202em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.508em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.739em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.971em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.126em;"></span></span><span style="position: absolute; clip: rect(2.615em, 1006.61em, 3.64em, -999.997em); top: -5.94em; left: 0em;"><span class="mo" id="MathJax-Span-781" style=""><span style="display: inline-block; position: relative; width: 6.611em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 0.003em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 5.689em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 2.359em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 0.822em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 1.335em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 1.847em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 4.101em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 4.613em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 5.126em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.945em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.44em, 4.306em, -999.997em); top: -7.374em; left: 2.564em;"><span class="texatom" id="MathJax-Span-782"><span class="mrow" id="MathJax-Span-783"><span class="mi" id="MathJax-Span-784" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-785" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="mi" id="MathJax-Span-786" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Q</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-787" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="munderover" id="MathJax-Span-788" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 6.406em; height: 0px;"><span style="position: absolute; clip: rect(2.666em, 1006.41em, 7.892em, -999.997em); top: -5.94em; left: 0em;"><span class="texatom" id="MathJax-Span-789"><span class="mrow" id="MathJax-Span-790"><span class="munderover" id="MathJax-Span-791"><span style="display: inline-block; position: relative; width: 6.406em; height: 0px;"><span style="position: absolute; clip: rect(2.666em, 1006.36em, 7.072em, -999.997em); top: -5.12em; left: 0.003em;"><span class="mrow" id="MathJax-Span-792"><span class="mo" id="MathJax-Span-793" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.202em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.508em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.739em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.971em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-794" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 5.177em; height: 0px;"><span style="position: absolute; clip: rect(2.462em, 1001.03em, 6.304em, -999.997em); top: -4.557em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1001.03em, 4.306em, -999.997em); top: -5.479em; left: 50%; margin-left: -0.51em;"><span class="mtd" id="MathJax-Span-795"><span class="mrow" id="MathJax-Span-796"><span class="msubsup" id="MathJax-Span-797"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-798" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-799" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-804"><span class="mrow" id="MathJax-Span-805"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-813"><span class="mrow" id="MathJax-Span-814"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.562em;"></span></span><span style="position: absolute; clip: rect(2.462em, 1001.03em, 5.843em, -999.997em); top: -4.096em; left: 2.154em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -5.479em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-800"><span class="mrow" id="MathJax-Span-801"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.03em, 4.306em, -999.997em); top: -4.045em; left: 50%; margin-left: -0.51em;"><span class="mtd" id="MathJax-Span-806"><span class="mrow" id="MathJax-Span-807"><span class="msubsup" id="MathJax-Span-808"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-809" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-810" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-815"><span class="mrow" id="MathJax-Span-816"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.101em;"></span></span><span style="position: absolute; clip: rect(2.513em, 1000.72em, 5.945em, -999.997em); top: -4.147em; left: 4.255em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -5.479em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-802"><span class="mrow" id="MathJax-Span-803"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-811"><span class="mrow" id="MathJax-Span-812"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1000.72em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-817"><span class="mrow" id="MathJax-Span-818"><span class="mo" id="MathJax-Span-819" style="font-family: STIXGeneral-Regular;">⋱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-820" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.202em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.508em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.739em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.971em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.126em;"></span></span><span style="position: absolute; clip: rect(2.615em, 1006.41em, 3.64em, -999.997em); top: -5.94em; left: 0em;"><span class="mo" id="MathJax-Span-821" style=""><span style="display: inline-block; position: relative; width: 6.406em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 0.003em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 5.484em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 2.257em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 0.771em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 1.283em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 1.796em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 3.998em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 4.511em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 4.972em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.945em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.8em, 4.306em, -999.997em); top: -7.374em; left: 2.257em;"><span class="texatom" id="MathJax-Span-822"><span class="mrow" id="MathJax-Span-823"><span class="mi" id="MathJax-Span-824" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-825" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="texatom" id="MathJax-Span-826"><span class="mrow" id="MathJax-Span-827"><span class="mo" id="MathJax-Span-828" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-829" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="texatom" id="MathJax-Span-830"><span class="mrow" id="MathJax-Span-831"><span class="mo" id="MathJax-Span-832" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-833"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(2.82em, 1001.44em, 4.306em, -999.997em); top: -3.993em; left: 0.412em;"><span class="texatom" id="MathJax-Span-834"><span class="mrow" id="MathJax-Span-835"><span class="munderover" id="MathJax-Span-836"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.23em, 4.306em, -999.997em); top: -3.993em; left: 0.105em;"><span class="msubsup" id="MathJax-Span-837"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-838"><span class="mrow" id="MathJax-Span-839"><span class="mi" id="MathJax-Span-840" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-841" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.691em, 1001.44em, 4.255em, -999.997em); top: -4.864em; left: 0em;"><span class="mo" id="MathJax-Span-842" style=""><span style="font-family: STIXSizeTwoSym;">⏞</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1002.26em, 4.306em, -999.997em); top: -5.274em; left: 0em;"><span class="texatom" id="MathJax-Span-843"><span class="mrow" id="MathJax-Span-844"><span class="texatom" id="MathJax-Span-845"><span class="mrow" id="MathJax-Span-846"><span class="mo" id="MathJax-Span-847" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-848" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="texatom" id="MathJax-Span-849"><span class="mrow" id="MathJax-Span-850"><span class="mo" id="MathJax-Span-851" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-852" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="texatom" id="MathJax-Span-853"><span class="mrow" id="MathJax-Span-854"><span class="mo" id="MathJax-Span-855" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-856" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="texatom" id="MathJax-Span-857"><span class="mrow" id="MathJax-Span-858"><span class="mo" id="MathJax-Span-859" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-860"><span style="display: inline-block; position: relative; width: 6.714em; height: 0px;"><span style="position: absolute; clip: rect(2.666em, 1006.71em, 7.892em, -999.997em); top: -5.94em; left: 0em;"><span class="texatom" id="MathJax-Span-861"><span class="mrow" id="MathJax-Span-862"><span class="munderover" id="MathJax-Span-863"><span style="display: inline-block; position: relative; width: 6.714em; height: 0px;"><span style="position: absolute; clip: rect(2.666em, 1006.66em, 7.072em, -999.997em); top: -5.12em; left: 0.003em;"><span class="mrow" id="MathJax-Span-864"><span class="mo" id="MathJax-Span-865" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.202em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.508em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.739em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.971em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-866" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 5.484em; height: 0px;"><span style="position: absolute; clip: rect(2.462em, 1001.18em, 6.304em, -999.997em); top: -4.557em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1001.18em, 4.306em, -999.997em); top: -5.479em; left: 50%; margin-left: -0.561em;"><span class="mtd" id="MathJax-Span-867"><span class="mrow" id="MathJax-Span-868"><span class="msubsup" id="MathJax-Span-869"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-870" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mn" id="MathJax-Span-871" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-876"><span class="mrow" id="MathJax-Span-877"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-885"><span class="mrow" id="MathJax-Span-886"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.562em;"></span></span><span style="position: absolute; clip: rect(2.462em, 1001.18em, 5.843em, -999.997em); top: -4.096em; left: 2.308em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -5.479em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-872"><span class="mrow" id="MathJax-Span-873"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.18em, 4.306em, -999.997em); top: -4.045em; left: 50%; margin-left: -0.561em;"><span class="mtd" id="MathJax-Span-878"><span class="mrow" id="MathJax-Span-879"><span class="msubsup" id="MathJax-Span-880"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-881" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mn" id="MathJax-Span-882" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-887"><span class="mrow" id="MathJax-Span-888"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.101em;"></span></span><span style="position: absolute; clip: rect(2.513em, 1000.72em, 5.945em, -999.997em); top: -4.147em; left: 4.562em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -5.479em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-874"><span class="mrow" id="MathJax-Span-875"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-883"><span class="mrow" id="MathJax-Span-884"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1000.72em, 4.152em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-889"><span class="mrow" id="MathJax-Span-890"><span class="mo" id="MathJax-Span-891" style="font-family: STIXGeneral-Regular;">⋱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.152em;"></span></span></span></span><span class="mo" id="MathJax-Span-892" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.202em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.508em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.739em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.971em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.126em;"></span></span><span style="position: absolute; clip: rect(2.615em, 1006.71em, 3.64em, -999.997em); top: -5.94em; left: 0em;"><span class="mo" id="MathJax-Span-893" style=""><span style="display: inline-block; position: relative; width: 6.714em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 0.003em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 5.791em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.993em; left: 2.462em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 0.822em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 1.335em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 1.898em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 4.203em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 4.716em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.993em; left: 5.279em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.945em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.9em, 4.306em, -999.997em); top: -7.374em; left: 2.41em;"><span class="texatom" id="MathJax-Span-894"><span class="mrow" id="MathJax-Span-895"><span class="texatom" id="MathJax-Span-896"><span class="mrow" id="MathJax-Span-897"><span class="mo" id="MathJax-Span-898" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-899" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="texatom" id="MathJax-Span-900"><span class="mrow" id="MathJax-Span-901"><span class="mo" id="MathJax-Span-902" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-903" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="mi" id="MathJax-Span-904" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Q</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.257em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.247em; border-left: 0px solid; width: 0px; height: 7.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>D</mi></msub><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>P</mi></msub><mo>+</mo><msub><mi mathvariant="bold-italic">A</mi><mi>P</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>G</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Ω</mi></mrow><mi>P</mi></msub><mo>=</mo><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mn>1</mn></msub></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mn>2</mn></msub></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd><mo>⋱</mo></mtd></mtr></mtable><mo>]</mo></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mo>×</mo><mi>Q</mi></mrow></mover><mo>+</mo><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi mathvariant="bold-italic">α</mi><mn>1</mn></msub></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msub><mi mathvariant="bold-italic">α</mi><mn>2</mn></msub></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd><mo>⋱</mo></mtd></mtr></mtable><mo>]</mo></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mover><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>G</mi></msub><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mover><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi mathvariant="bold-italic">ω</mi><mn>1</mn></msub></mtd><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msub><mi mathvariant="bold-italic">ω</mi><mn>2</mn></msub></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd><mo>⋱</mo></mtd></mtr></mtable><mo>]</mo></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>×</mo><mi>Q</mi></mrow></mover></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-25">
\mathbf{T}_D = \mathbf{T}_P + \boldsymbol{A}_P \mathbf{T}_G \mathbf{\Omega}_P = \overbrace{\begin{bmatrix} 
    \mathbf{T}_1 & & \\
    & \mathbf{T}_2 & \\
    & & \ddots
\end{bmatrix}}^{Q \times Q} + \overbrace{\begin{bmatrix} 
    \boldsymbol{\alpha}_1 & & \\
    & \boldsymbol{\alpha}_2 & \\
    & & \ddots
\end{bmatrix}}^{Q \times |V|} 
\overbrace{\mathbf{T}_G}^{|V| \times |V|} 
\overbrace{\begin{bmatrix}
    \boldsymbol{\omega}_1 & & \\
    & \boldsymbol{\omega}_2 & \\
    & & \ddots
\end{bmatrix}}^{|V| \times Q}
</script></span><br>
where <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-905" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.39em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-906"><span class="texatom" id="MathJax-Span-907"><span class="mrow" id="MathJax-Span-908"><span class="mo" id="MathJax-Span-909" style="font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-910" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="texatom" id="MathJax-Span-911"><span class="mrow" id="MathJax-Span-912"><span class="mo" id="MathJax-Span-913" style="font-family: STIXVariants;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-26">|V|</script></span> is the size of the vocabulary.</p><p>During inference:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>D</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mo>=</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>P</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mo>+</mo><msubsup><mi mathvariant=&quot;bold&quot;>&amp;#x03A9;</mi><mi>P</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>[</mo></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>G</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msubsup><mi mathvariant=&quot;bold-italic&quot;>A</mi><mi>P</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>]</mo></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-914" style="width: 14.654em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.99em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.205em, 1011.78em, 4.357em, -999.997em); top: -3.532em; left: 0em;"><span class="mrow" id="MathJax-Span-915"><span class="msubsup" id="MathJax-Span-916"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-917"><span class="mrow" id="MathJax-Span-918"><span class="mi" id="MathJax-Span-919" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.403em; left: 0.669em;"><span class="mi" id="MathJax-Span-920" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.737em; left: 0.669em;"><span class="mi" id="MathJax-Span-921" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-922"><span class="mrow" id="MathJax-Span-923"><span class="mi" id="MathJax-Span-924" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span class="mo" id="MathJax-Span-925" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-926" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-927"><span class="mrow" id="MathJax-Span-928"><span class="mi" id="MathJax-Span-929" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.403em; left: 0.669em;"><span class="mi" id="MathJax-Span-930" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.737em; left: 0.669em;"><span class="mi" id="MathJax-Span-931" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-932"><span class="mrow" id="MathJax-Span-933"><span class="mi" id="MathJax-Span-934" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span class="mo" id="MathJax-Span-935" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="msubsup" id="MathJax-Span-936" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-937" style="font-family: STIXGeneral; font-weight: bold;">Ω</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.771em;"><span class="mi" id="MathJax-Span-938" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.686em; left: 0.771em;"><span class="mi" id="MathJax-Span-939" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-940"><span class="mrow" id="MathJax-Span-941"><span class="mo" id="MathJax-Span-942" style="vertical-align: -0.407em;"><span style="font-family: STIXSizeTwoSym;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-943"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-944"><span class="mrow" id="MathJax-Span-945"><span class="mi" id="MathJax-Span-946" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.403em; left: 0.669em;"><span class="mi" id="MathJax-Span-947" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.737em; left: 0.669em;"><span class="mi" id="MathJax-Span-948" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-949" style=""><span class="mrow" id="MathJax-Span-950"><span class="mo" id="MathJax-Span-951" style="vertical-align: -0.254em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span></span></span><span class="msubsup" id="MathJax-Span-952"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-953" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.669em;"><span class="mi" id="MathJax-Span-954" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.686em; left: 0.669em;"><span class="mi" id="MathJax-Span-955" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-956"><span class="mrow" id="MathJax-Span-957"><span class="mi" id="MathJax-Span-958" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span class="texatom" id="MathJax-Span-959" style=""><span class="mrow" id="MathJax-Span-960"><span class="mo" id="MathJax-Span-961" style="vertical-align: -0.254em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span></span><span class="texatom" id="MathJax-Span-962"><span class="mrow" id="MathJax-Span-963"><span class="mo" id="MathJax-Span-964" style="vertical-align: -0.407em;"><span style="font-family: STIXSizeTwoSym;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>D</mi><mi mathvariant="normal">⊤</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>P</mi><mi mathvariant="normal">⊤</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mo>+</mo><msubsup><mi mathvariant="bold">Ω</mi><mi>P</mi><mi mathvariant="normal">⊤</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">[</mo></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>G</mi><mi mathvariant="normal">⊤</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><msubsup><mi mathvariant="bold-italic">A</mi><mi>P</mi><mi mathvariant="normal">⊤</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">
\mathbf{T}^\top_D \mathbf{v} = \mathbf{T}^\top_P \mathbf{v} + \boldsymbol{\Omega}^\top_P \Big[ \mathbf{T}_G^\top \big( \boldsymbol{A}^\top_P 
\mathbf{v} \big) \Big]
</script></span></p><h2 id="Inference-with-neural-networks"><a class="anchor hidden-xs" href="#Inference-with-neural-networks" title="Inference-with-neural-networks"><i class="fa fa-link"></i></a>Inference with neural networks</h2><p>Let <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>Y</mi></mrow><mo>=</mo><msub><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>X</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-965" style="width: 5.126em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.203em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1004.15em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-966"><span class="texatom" id="MathJax-Span-967"><span class="mrow" id="MathJax-Span-968"><span class="mi" id="MathJax-Span-969" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span class="mo" id="MathJax-Span-970" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-971" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-972" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-973"><span class="mrow" id="MathJax-Span-974"><span class="mi" id="MathJax-Span-975" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-976" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-977"><span class="mrow" id="MathJax-Span-978"><span class="mi" id="MathJax-Span-979" style="font-family: STIXGeneral; font-weight: bold;">X</span></span></span><span class="mo" id="MathJax-Span-980" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mo>=</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28">\mathbf{Y} = g_{\theta}(\mathbf{X})</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>Y</mi></mrow><mo>&amp;#x2208;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>M</mi><mo>&amp;#x00D7;</mo><mi>N</mi></mrow></msup></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-981" style="width: 5.433em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.46em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1004.46em, 2.769em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-982"><span class="texatom" id="MathJax-Span-983"><span class="mrow" id="MathJax-Span-984"><span class="mi" id="MathJax-Span-985" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span class="mo" id="MathJax-Span-986" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">∈</span><span class="msubsup" id="MathJax-Span-987" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-988"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-family: STIXGeneral-Regular;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.771em;"><span class="texatom" id="MathJax-Span-991"><span class="mrow" id="MathJax-Span-992"><span class="mi" id="MathJax-Span-993" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-994" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="mi" id="MathJax-Span-995" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>M</mi><mo>×</mo><mi>N</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-29">\mathbf{Y} \in \mathbb{R}^{M \times N}</script></span>, be the output of a neural network.</p><pre class="graphviz"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %0 Pages: 1 -->
<svg width="337pt" height="131pt" viewBox="0.00 0.00 337.20 131.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 127.0775)">
<title>%0</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-127.0775 333.2,-127.0775 333.2,4 -4,4"></polygon>
<!-- n0 -->
<g id="node1" class="node">
<title>n0</title>
<ellipse fill="#000000" stroke="#000000" cx="1.8" cy="-61.2775" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- n1 -->
<g id="node2" class="node">
<title>n1</title>
<ellipse fill="none" stroke="#000000" cx="78.6" cy="-88.2775" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="78.6" y="-84.0775" font-family="Times,serif" font-size="14.00" fill="#000000">a</text>
</g>
<!-- n0&#45;&gt;n1 -->
<g id="edge1" class="edge">
<title>n0-&gt;n1</title>
<path fill="none" stroke="#000000" d="M3.6984,-61.9449C10.3556,-64.2853 33.2509,-72.3344 51.9943,-78.9239"></path>
<polygon fill="#000000" stroke="#000000" points="50.9846,-82.2789 61.5794,-82.2937 53.3063,-75.6751 50.9846,-82.2789"></polygon>
<text text-anchor="middle" x="32.1" y="-79.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x11</text>
</g>
<!-- n2 -->
<g id="node3" class="node">
<title>n2</title>
<ellipse fill="none" stroke="#000000" cx="78.6" cy="-34.2775" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="78.6" y="-30.0775" font-family="Times,serif" font-size="14.00" fill="#000000">b</text>
</g>
<!-- n0&#45;&gt;n2 -->
<g id="edge2" class="edge">
<title>n0-&gt;n2</title>
<path fill="none" stroke="#000000" d="M3.5417,-59.8635C6.8571,-57.2403 14.3892,-51.6031 21.6,-48.4775 30.8079,-44.4862 41.3593,-41.4651 50.8607,-39.2582"></path>
<polygon fill="#000000" stroke="#000000" points="51.5931,-42.6808 60.6453,-37.1756 50.1358,-35.8342 51.5931,-42.6808"></polygon>
<text text-anchor="middle" x="32.1" y="-53.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x12</text>
</g>
<!-- n3 -->
<g id="node4" class="node">
<title>n3</title>
<ellipse fill="none" stroke="#000000" cx="171.6" cy="-101.2775" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="171.6" y="-97.0775" font-family="Times,serif" font-size="14.00" fill="#000000">a</text>
</g>
<!-- n1&#45;&gt;n3 -->
<g id="edge3" class="edge">
<title>n1-&gt;n3</title>
<path fill="none" stroke="#000000" d="M95.5938,-94.4677C101.5272,-96.3607 108.2833,-98.2204 114.6,-99.2775 123.8656,-100.828 134.0923,-101.504 143.2951,-101.7407"></path>
<polygon fill="#000000" stroke="#000000" points="143.4746,-105.2425 153.5091,-101.8428 143.5446,-98.2429 143.4746,-105.2425"></polygon>
<text text-anchor="middle" x="125.1" y="-105.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x21</text>
</g>
<!-- n4 -->
<g id="node5" class="node">
<title>n4</title>
<ellipse fill="none" stroke="#000000" cx="171.6" cy="-34.2775" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="171.6" y="-30.0775" font-family="Times,serif" font-size="14.00" fill="#000000">b</text>
</g>
<!-- n1&#45;&gt;n4 -->
<g id="edge4" class="edge">
<title>n1-&gt;n4</title>
<path fill="none" stroke="#000000" d="M95.3845,-80.4844C106.9127,-74.9524 122.4488,-67.1395 135.6,-59.2775 139.8657,-56.7274 144.298,-53.8513 148.5343,-50.9814"></path>
<polygon fill="#000000" stroke="#000000" points="150.6271,-53.7892 156.8383,-45.206 146.6302,-48.0424 150.6271,-53.7892"></polygon>
<text text-anchor="middle" x="125.1" y="-75.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x22</text>
</g>
<!-- n2&#45;&gt;n3 -->
<g id="edge5" class="edge">
<title>n2-&gt;n3</title>
<path fill="none" stroke="#000000" d="M96.6419,-31.4612C108.5807,-30.5409 124.0962,-31.2345 135.6,-38.4775 142.7776,-42.9967 152.395,-60.2102 159.8836,-75.4746"></path>
<polygon fill="#000000" stroke="#000000" points="156.7688,-77.0743 164.2304,-84.596 163.0879,-74.0629 156.7688,-77.0743"></polygon>
<text text-anchor="middle" x="125.1" y="-43.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x21</text>
</g>
<!-- n2&#45;&gt;n4 -->
<g id="edge6" class="edge">
<title>n2-&gt;n4</title>
<path fill="none" stroke="#000000" d="M90.0435,-20.22C96.4626,-13.4692 105.0847,-6.0783 114.6,-2.4775 123.3292,.8258 126.8708,.8258 135.6,-2.4775 141.8444,-4.8405 147.7041,-8.8358 152.809,-13.2113"></path>
<polygon fill="#000000" stroke="#000000" points="150.5048,-15.8502 160.1565,-20.22 155.3364,-10.7851 150.5048,-15.8502"></polygon>
<text text-anchor="middle" x="125.1" y="-7.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x22</text>
</g>
<!-- n5 -->
<g id="node6" class="node">
<title>n5</title>
<ellipse fill="none" stroke="#000000" cx="264.6" cy="-95.2775" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="264.6" y="-91.0775" font-family="Times,serif" font-size="14.00" fill="#000000">a</text>
</g>
<!-- n3&#45;&gt;n5 -->
<g id="edge7" class="edge">
<title>n3-&gt;n5</title>
<path fill="none" stroke="#000000" d="M189.3813,-104.9828C200.6584,-106.8035 215.533,-108.2293 228.6,-106.2775 231.6682,-105.8192 234.8363,-105.1527 237.9618,-104.3709"></path>
<polygon fill="#000000" stroke="#000000" points="238.9815,-107.7196 247.6263,-101.5945 237.0486,-100.9917 238.9815,-107.7196"></polygon>
<text text-anchor="middle" x="218.1" y="-110.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x31</text>
</g>
<!-- n6 -->
<g id="node7" class="node">
<title>n6</title>
<ellipse fill="none" stroke="#000000" cx="264.6" cy="-41.2775" rx="18" ry="18"></ellipse>
<text text-anchor="middle" x="264.6" y="-37.0775" font-family="Times,serif" font-size="14.00" fill="#000000">b</text>
</g>
<!-- n3&#45;&gt;n6 -->
<g id="edge8" class="edge">
<title>n3-&gt;n6</title>
<path fill="none" stroke="#000000" d="M187.231,-92.0036C198.7685,-85.0802 214.7964,-75.2981 228.6,-66.2775 232.7602,-63.5588 237.1409,-60.6001 241.3588,-57.7008"></path>
<polygon fill="#000000" stroke="#000000" points="243.4502,-60.5095 249.6651,-51.9289 239.4558,-54.7611 243.4502,-60.5095"></polygon>
<text text-anchor="middle" x="218.1" y="-82.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x32</text>
</g>
<!-- n4&#45;&gt;n5 -->
<g id="edge9" class="edge">
<title>n4-&gt;n5</title>
<path fill="none" stroke="#000000" d="M189.8172,-34.4785C201.6837,-35.3837 217.0487,-38.0825 228.6,-45.4775 231.4739,-47.3173 240.4675,-59.7575 248.7458,-71.7426"></path>
<polygon fill="#000000" stroke="#000000" points="246.0161,-73.9515 254.5495,-80.2311 251.7946,-70.0007 246.0161,-73.9515"></polygon>
<text text-anchor="middle" x="218.1" y="-50.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x31</text>
</g>
<!-- n4&#45;&gt;n6 -->
<g id="edge10" class="edge">
<title>n4-&gt;n6</title>
<path fill="none" stroke="#000000" d="M185.2531,-21.9615C191.5783,-17.0651 199.4835,-12.0026 207.6,-9.4775 216.512,-6.7049 219.8708,-6.1742 228.6,-9.4775 234.8444,-11.8405 240.7041,-15.8358 245.809,-20.2113"></path>
<polygon fill="#000000" stroke="#000000" points="243.5048,-22.8502 253.1565,-27.22 248.3364,-17.7851 243.5048,-22.8502"></polygon>
<text text-anchor="middle" x="218.1" y="-14.4775" font-family="Times,serif" font-size="14.00" fill="#000000">x32</text>
</g>
<!-- n7 -->
<g id="node8" class="node">
<title>n7</title>
<ellipse fill="#000000" stroke="#000000" cx="327.4" cy="-68.2775" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- n5&#45;&gt;n7 -->
<g id="edge11" class="edge">
<title>n5-&gt;n7</title>
<path fill="none" stroke="#000000" d="M281.4292,-88.042C292.4652,-83.2972 306.5866,-77.2259 316.2482,-73.072"></path>
<polygon fill="#000000" stroke="#000000" points="317.7288,-76.2453 325.5333,-69.08 314.9639,-69.8145 317.7288,-76.2453"></polygon>
<text text-anchor="middle" x="304.1" y="-83.4775" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- n6&#45;&gt;n7 -->
<g id="edge12" class="edge">
<title>n6-&gt;n7</title>
<path fill="none" stroke="#000000" d="M282.1514,-45.966C290.1046,-48.3689 299.5159,-51.608 307.6,-55.4775 310.9229,-57.068 314.3566,-59.1222 317.4125,-61.1175"></path>
<polygon fill="#000000" stroke="#000000" points="315.4454,-64.013 325.6354,-66.9137 319.4783,-58.2915 315.4454,-64.013"></polygon>
<text text-anchor="middle" x="304.1" y="-60.4775" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
</g>
</svg>
</pre><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>B</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>0</mn></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>1</mn></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow><mn>2</mn><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup></mtd><mtd /></mtr><mtr><mtd /><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>0</mn></mrow></mtd><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>1</mn></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow><mn>3</mn><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup></mtd><mtd /></mtr><mtr><mtd /><mtd /><mtd><mo>&amp;#x22F1;</mo></mtd><mtd><mo>&amp;#x22F1;</mo></mtd></mtr></mtable><mo>]</mo></mrow><mspace width=&quot;thickmathspace&quot; /><msub><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B1;</mi><mi>A</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow><mn>1</mn></msub></mtd></mtr><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>0</mn></mrow></mtd></mtr><mtr><mtd><mo>&amp;#x22EE;</mo></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-996" style="width: 20.136em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.498em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.103em, 1016.45em, 6.816em, -999.997em); top: -4.711em; left: 0em;"><span class="mrow" id="MathJax-Span-997"><span class="msubsup" id="MathJax-Span-998"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-999"><span class="mrow" id="MathJax-Span-1000"><span class="mi" id="MathJax-Span-1001" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1003" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-1004" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-1005" style="vertical-align: 2.462em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.054em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.456em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.637em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.766em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1006" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 7.943em; height: 0px;"><span style="position: absolute; clip: rect(2.615em, 1000.46em, 6.97em, -999.997em); top: -5.069em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -5.633em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-1007"><span class="mrow" id="MathJax-Span-1008"><span class="texatom" id="MathJax-Span-1009"><span class="mrow" id="MathJax-Span-1010"><span class="mn" id="MathJax-Span-1011" style="font-family: STIXGeneral; font-weight: bold;">0</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1025"><span class="mrow" id="MathJax-Span-1026"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.252em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1045"><span class="mrow" id="MathJax-Span-1046"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.074em;"></span></span><span style="position: absolute; clip: rect(2.564em, 1001.54em, 7.072em, -999.997em); top: -5.172em; left: 1.642em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.025em, 1001.54em, 4.46em, -999.997em); top: -5.633em; left: 50%; margin-left: -0.766em;"><span class="mtd" id="MathJax-Span-1012"><span class="mrow" id="MathJax-Span-1013"><span class="texatom" id="MathJax-Span-1014"><span class="mrow" id="MathJax-Span-1015"><span class="mn" id="MathJax-Span-1016" style="font-family: STIXGeneral; font-weight: bold;">1</span></span></span><span class="msubsup" id="MathJax-Span-1017"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1018"><span class="mrow" id="MathJax-Span-1019"><span class="mi" id="MathJax-Span-1020" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-1021" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mn" id="MathJax-Span-1022" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-1027"><span class="mrow" id="MathJax-Span-1028"><span class="texatom" id="MathJax-Span-1029"><span class="mrow" id="MathJax-Span-1030"><span class="mn" id="MathJax-Span-1031" style="font-family: STIXGeneral; font-weight: bold;">0</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.252em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1047"><span class="mrow" id="MathJax-Span-1048"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.177em;"></span></span><span style="position: absolute; clip: rect(2.615em, 1001.54em, 6.304em, -999.997em); top: -4.403em; left: 4.306em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -5.633em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1023"><span class="mrow" id="MathJax-Span-1024"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.025em, 1001.54em, 4.46em, -999.997em); top: -4.045em; left: 50%; margin-left: -0.766em;"><span class="mtd" id="MathJax-Span-1032"><span class="mrow" id="MathJax-Span-1033"><span class="texatom" id="MathJax-Span-1034"><span class="mrow" id="MathJax-Span-1035"><span class="mn" id="MathJax-Span-1036" style="font-family: STIXGeneral; font-weight: bold;">1</span></span></span><span class="msubsup" id="MathJax-Span-1037"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1038"><span class="mrow" id="MathJax-Span-1039"><span class="mi" id="MathJax-Span-1040" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-1041" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mn" id="MathJax-Span-1042" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1000.72em, 4.152em, -999.997em); top: -2.252em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-1049"><span class="mrow" id="MathJax-Span-1050"><span class="mo" id="MathJax-Span-1051" style="font-family: STIXGeneral-Regular;">⋱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.408em;"></span></span><span style="position: absolute; clip: rect(3.794em, 1000.72em, 5.894em, -999.997em); top: -3.993em; left: 7.021em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1043"><span class="mrow" id="MathJax-Span-1044"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1000.72em, 4.152em, -999.997em); top: -2.252em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-1052"><span class="mrow" id="MathJax-Span-1053"><span class="mo" id="MathJax-Span-1054" style="font-family: STIXGeneral-Regular;">⋱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1055" style="vertical-align: 2.462em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.054em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.456em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.637em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.766em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mspace" id="MathJax-Span-1056" style="height: 0em; vertical-align: 0em; width: 0.31em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1057" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1058" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1059" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1060" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-1061" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-1062" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.202em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.739em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.971em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1063" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(2.564em, 1000.92em, 6.509em, -999.997em); top: -4.659em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.92em, 4.306em, -999.997em); top: -5.479em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-1064"><span class="mrow" id="MathJax-Span-1065"><span class="msubsup" id="MathJax-Span-1066"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1067"><span class="mrow" id="MathJax-Span-1068"><span class="mi" id="MathJax-Span-1069" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1070" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-1071"><span class="mrow" id="MathJax-Span-1072"><span class="texatom" id="MathJax-Span-1073"><span class="mrow" id="MathJax-Span-1074"><span class="mn" id="MathJax-Span-1075" style="font-family: STIXGeneral; font-weight: bold;">0</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1000.31em, 4.255em, -999.997em); top: -2.405em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-1076"><span class="mrow" id="MathJax-Span-1077"><span class="mo" id="MathJax-Span-1078" style="font-family: STIXGeneral-Regular;">⋮</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.664em;"></span></span></span></span><span class="mo" id="MathJax-Span-1079" style="vertical-align: 2.308em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.202em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.559em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.739em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.971em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.434em; border-left: 0px solid; width: 0px; height: 5.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>B</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">0</mn></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">1</mn></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>2</mn><mi mathvariant="normal">⊤</mi></msubsup></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">0</mn></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">1</mn></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>3</mn><mi mathvariant="normal">⊤</mi></msubsup></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd><mo>⋱</mo></mtd><mtd><mo>⋱</mo></mtd></mtr></mtable><mo>]</mo></mrow><mspace width="thickmathspace"></mspace><msub><mi mathvariant="bold-italic">α</mi><mi>A</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>1</mn></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">0</mn></mrow></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">
\mathbf{T}_B = 
\begin{bmatrix}
    \mathbf{0} & \mathbf{1} \mathbf{x}_2^\top  & \\
     & \mathbf{0} & \mathbf{1} \mathbf{x}_3^\top  & \\
     & & \ddots & \ddots
\end{bmatrix} \; \boldsymbol{\alpha}_A = \begin{bmatrix} \mathbf{x}_1 \\ \mathbf{0} \\ \vdots \end{bmatrix} 
</script></span></p><ol>
<li>
<p>Intersection (generic A and B):<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>A</mi><mo>&amp;#x2229;</mo><mi>B</mi></mrow></msub><mo>=</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>M</mi></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>A</mi></msub><mo>&amp;#x2297;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>B</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>M</mi></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1080" style="width: 12.195em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.992em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1009.99em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1081"><span class="msubsup" id="MathJax-Span-1082"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1083"><span class="mrow" id="MathJax-Span-1084"><span class="mi" id="MathJax-Span-1085" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="texatom" id="MathJax-Span-1086"><span class="mrow" id="MathJax-Span-1087"><span class="mi" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">A</span><span class="mo" id="MathJax-Span-1089" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∩</span><span class="mi" id="MathJax-Span-1090" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1091" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-1092" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.92em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1093"><span class="mrow" id="MathJax-Span-1094"><span class="mi" id="MathJax-Span-1095" style="font-family: STIXGeneral; font-weight: bold;">M</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.925em;"><span class="mi" id="MathJax-Span-1096" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1097" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1098"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1099"><span class="mrow" id="MathJax-Span-1100"><span class="mi" id="MathJax-Span-1101" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-1102" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1103" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⊗</span><span class="msubsup" id="MathJax-Span-1104" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1105"><span class="mrow" id="MathJax-Span-1106"><span class="mi" id="MathJax-Span-1107" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-1108" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1109" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-1110"><span class="mrow" id="MathJax-Span-1111"><span class="mi" id="MathJax-Span-1112" style="font-family: STIXGeneral; font-weight: bold;">M</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>A</mi><mo>∩</mo><mi>B</mi></mrow></msub><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">M</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>A</mi></msub><mo>⊗</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>B</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">M</mi></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">
\mathbf{T}_{A \cap B} = \mathbf{M}^\top (\mathbf{T}_A \otimes \mathbf{T}_B) \mathbf{M}
</script></span></p>
</li>
<li>
<p>Intersection (A is dense acyclic and generic B):<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>A</mi><mo>&amp;#x2229;</mo><mi>B</mi></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>0</mn></mrow></mtd><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>A</mi></msub><mo>&amp;#x2218;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>1</mn></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow><mn>1</mn><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup></mtd><mtd /></mtr><mtr><mtd /><mtd><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>0</mn></mrow></mtd><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>A</mi></msub><mo>&amp;#x2218;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;bold&quot;>1</mn></mrow><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow><mn>1</mn><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup></mtd><mtd /></mtr><mtr><mtd /><mtd /><mtd><mo>&amp;#x22F1;</mo></mtd><mtd><mo>&amp;#x22F1;</mo></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1113" style="width: 20.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.447em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.103em, 1016.4em, 6.816em, -999.997em); top: -4.711em; left: 0em;"><span class="mrow" id="MathJax-Span-1114"><span class="msubsup" id="MathJax-Span-1115"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1116"><span class="mrow" id="MathJax-Span-1117"><span class="mi" id="MathJax-Span-1118" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="texatom" id="MathJax-Span-1119"><span class="mrow" id="MathJax-Span-1120"><span class="mi" id="MathJax-Span-1121" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">A</span><span class="mo" id="MathJax-Span-1122" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∩</span><span class="mi" id="MathJax-Span-1123" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1124" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-1125" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-1126" style="vertical-align: 2.462em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.054em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.456em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.637em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.766em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1127" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 11.99em; height: 0px;"><span style="position: absolute; clip: rect(2.615em, 1000.46em, 6.97em, -999.997em); top: -5.069em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -5.633em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-1128"><span class="mrow" id="MathJax-Span-1129"><span class="texatom" id="MathJax-Span-1130"><span class="mrow" id="MathJax-Span-1131"><span class="mn" id="MathJax-Span-1132" style="font-family: STIXGeneral; font-weight: bold;">0</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1152"><span class="mrow" id="MathJax-Span-1153"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.252em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1178"><span class="mrow" id="MathJax-Span-1179"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.074em;"></span></span><span style="position: absolute; clip: rect(2.564em, 1003.59em, 7.072em, -999.997em); top: -5.172em; left: 1.642em;"><span style="display: inline-block; position: relative; width: 3.589em; height: 0px;"><span style="position: absolute; clip: rect(3.025em, 1003.59em, 4.46em, -999.997em); top: -5.633em; left: 50%; margin-left: -1.79em;"><span class="mtd" id="MathJax-Span-1133"><span class="mrow" id="MathJax-Span-1134"><span class="msubsup" id="MathJax-Span-1135"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1136"><span class="mrow" id="MathJax-Span-1137"><span class="mi" id="MathJax-Span-1138" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-1139" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1140" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">∘</span><span class="texatom" id="MathJax-Span-1141" style="padding-left: 0.259em;"><span class="mrow" id="MathJax-Span-1142"><span class="mn" id="MathJax-Span-1143" style="font-family: STIXGeneral; font-weight: bold;">1</span></span></span><span class="msubsup" id="MathJax-Span-1144"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1145"><span class="mrow" id="MathJax-Span-1146"><span class="mi" id="MathJax-Span-1147" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-1148" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mn" id="MathJax-Span-1149" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: -0.254em;"><span class="mtd" id="MathJax-Span-1154"><span class="mrow" id="MathJax-Span-1155"><span class="texatom" id="MathJax-Span-1156"><span class="mrow" id="MathJax-Span-1157"><span class="mn" id="MathJax-Span-1158" style="font-family: STIXGeneral; font-weight: bold;">0</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.252em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1180"><span class="mrow" id="MathJax-Span-1181"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.177em;"></span></span><span style="position: absolute; clip: rect(2.564em, 1003.59em, 6.253em, -999.997em); top: -4.352em; left: 6.355em;"><span style="display: inline-block; position: relative; width: 3.589em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -5.633em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1150"><span class="mrow" id="MathJax-Span-1151"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.025em, 1003.59em, 4.46em, -999.997em); top: -4.045em; left: 50%; margin-left: -1.79em;"><span class="mtd" id="MathJax-Span-1159"><span class="mrow" id="MathJax-Span-1160"><span class="msubsup" id="MathJax-Span-1161"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1162"><span class="mrow" id="MathJax-Span-1163"><span class="mi" id="MathJax-Span-1164" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-1165" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1166" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">∘</span><span class="texatom" id="MathJax-Span-1167" style="padding-left: 0.259em;"><span class="mrow" id="MathJax-Span-1168"><span class="mn" id="MathJax-Span-1169" style="font-family: STIXGeneral; font-weight: bold;">1</span></span></span><span class="msubsup" id="MathJax-Span-1170"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1171"><span class="mrow" id="MathJax-Span-1172"><span class="mi" id="MathJax-Span-1173" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-1174" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mn" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1000.72em, 4.152em, -999.997em); top: -2.252em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-1182"><span class="mrow" id="MathJax-Span-1183"><span class="mo" id="MathJax-Span-1184" style="font-family: STIXGeneral-Regular;">⋱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.357em;"></span></span><span style="position: absolute; clip: rect(3.794em, 1000.72em, 5.894em, -999.997em); top: -3.993em; left: 11.068em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -4.045em; left: 50%; margin-left: 0em;"><span class="mtd" id="MathJax-Span-1176"><span class="mrow" id="MathJax-Span-1177"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1000.72em, 4.152em, -999.997em); top: -2.252em; left: 50%; margin-left: -0.459em;"><span class="mtd" id="MathJax-Span-1185"><span class="mrow" id="MathJax-Span-1186"><span class="mo" id="MathJax-Span-1187" style="font-family: STIXGeneral-Regular;">⋱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1188" style="vertical-align: 2.462em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.054em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.456em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.637em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.766em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.716em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.434em; border-left: 0px solid; width: 0px; height: 5.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>A</mi><mo>∩</mo><mi>B</mi></mrow></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">0</mn></mrow></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>A</mi></msub><mo>∘</mo><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">1</mn></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>1</mn><mi mathvariant="normal">⊤</mi></msubsup></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">0</mn></mrow></mtd><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>A</mi></msub><mo>∘</mo><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="bold">1</mn></mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>1</mn><mi mathvariant="normal">⊤</mi></msubsup></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd></mtd><mtd><mo>⋱</mo></mtd><mtd><mo>⋱</mo></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">
\mathbf{T}_{A \cap B} = 
\begin{bmatrix}
 \mathbf{0} & \mathbf{T}_A \circ \mathbf{1} \mathbf{x}_1^\top  & \\
  & \mathbf{0} & \mathbf{T}_A \circ \mathbf{1} \mathbf{x}_1^\top & \\
  & & \ddots & \ddots
\end{bmatrix}
</script></span><br>
and:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow><mn>1</mn></msub><mo>&amp;#x2218;</mo><msub><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03B1;</mi><mi>B</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mi>n</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>T</mi></mrow><mi>B</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2218;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>x</mi></mrow><mi>n</mi></msub></mtd></mtr><mtr><mtd><mi>W</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo>&amp;#x2229;</mo><mi>B</mi><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mi></mi><mo>=</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>v</mi></mrow><mi>N</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msubsup><msub><mi mathvariant=&quot;bold-italic&quot;>&amp;#x03C9;</mi><mi>B</mi></msub></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1189" style="width: 12.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.351em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.151em, 1010.2em, 4.05em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1190"><span class="mtable" id="MathJax-Span-1191" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 10.044em; height: 0px;"><span style="position: absolute; clip: rect(2.462em, 1003.9em, 6.201em, -999.997em); top: -4.454em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.947em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.92em, 4.306em, -999.997em); top: -5.377em; right: 0em;"><span class="mtd" id="MathJax-Span-1192"><span class="mrow" id="MathJax-Span-1193"><span class="msubsup" id="MathJax-Span-1194"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1195"><span class="mrow" id="MathJax-Span-1196"><span class="mi" id="MathJax-Span-1197" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1198" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.92em, 4.306em, -999.997em); top: -3.993em; right: 0em;"><span class="mtd" id="MathJax-Span-1212"><span class="mrow" id="MathJax-Span-1213"><span class="msubsup" id="MathJax-Span-1214"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1215"><span class="mrow" id="MathJax-Span-1216"><span class="mi" id="MathJax-Span-1217" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1218" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.9em, 4.306em, -999.997em); top: -2.61em; right: 0em;"><span class="mtd" id="MathJax-Span-1244"><span class="mrow" id="MathJax-Span-1245"><span class="mi" id="MathJax-Span-1246" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1247" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1248" style="font-family: STIXGeneral-Italic;">A</span><span class="mo" id="MathJax-Span-1249" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">∩</span><span class="mi" id="MathJax-Span-1250" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">B</span><span class="mo" id="MathJax-Span-1251" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.46em;"></span></span><span style="position: absolute; clip: rect(2.513em, 1006.1em, 6.406em, -999.997em); top: -4.557em; left: 3.947em;"><span style="display: inline-block; position: relative; width: 6.099em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1004.2em, 4.306em, -999.997em); top: -5.377em; left: 0em;"><span class="mtd" id="MathJax-Span-1199"><span class="mrow" id="MathJax-Span-1200"><span class="mi" id="MathJax-Span-1201"></span><span class="mo" id="MathJax-Span-1202" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-1203" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1204"><span class="mrow" id="MathJax-Span-1205"><span class="mi" id="MathJax-Span-1206" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1207" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1208" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">∘</span><span class="msubsup" id="MathJax-Span-1209" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1210" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">α</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1211" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1006.1em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mtd" id="MathJax-Span-1219"><span class="mrow" id="MathJax-Span-1220"><span class="mi" id="MathJax-Span-1221"></span><span class="mo" id="MathJax-Span-1222" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-1223" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.62em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1224"><span class="mrow" id="MathJax-Span-1225"><span class="mi" id="MathJax-Span-1226" style="font-family: STIXGeneral; font-weight: bold;">T</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.403em; left: 0.669em;"><span class="mi" id="MathJax-Span-1227" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.737em; left: 0.669em;"><span class="mi" id="MathJax-Span-1228" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1229"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1230"><span class="mrow" id="MathJax-Span-1231"><span class="mi" id="MathJax-Span-1232" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-1233"><span class="mrow" id="MathJax-Span-1234"><span class="mi" id="MathJax-Span-1235" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-1236" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1237" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1238" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">∘</span><span class="msubsup" id="MathJax-Span-1239" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1240"><span class="mrow" id="MathJax-Span-1241"><span class="mi" id="MathJax-Span-1242" style="font-family: STIXGeneral; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1243" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.025em, 1003.64em, 4.46em, -999.997em); top: -2.61em; left: 0em;"><span class="mtd" id="MathJax-Span-1252"><span class="mrow" id="MathJax-Span-1253"><span class="mi" id="MathJax-Span-1254"></span><span class="mo" id="MathJax-Span-1255" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-1256" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1257"><span class="mrow" id="MathJax-Span-1258"><span class="mi" id="MathJax-Span-1259" style="font-family: STIXGeneral; font-weight: bold;">v</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mi" id="MathJax-Span-1260" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⊤</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mi" id="MathJax-Span-1261" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1262"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1263" style="font-family: STIXGeneral; font-style: italic; font-weight: bold;">ω</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-1264" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.562em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.122em; border-left: 0px solid; width: 0px; height: 4.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>1</mn></msub><mo>∘</mo><msub><mi mathvariant="bold-italic">α</mi><mi>B</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>n</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">T</mi></mrow><mi>B</mi><mi mathvariant="normal">⊤</mi></msubsup><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∘</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>n</mi></msub></mtd></mtr><mtr><mtd><mi>W</mi><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">v</mi></mrow><mi>N</mi><mi mathvariant="normal">⊤</mi></msubsup><msub><mi mathvariant="bold-italic">ω</mi><mi>B</mi></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">
\begin{align}
\mathbf{v}_1 &= \mathbf{x}_1 \circ \boldsymbol{\alpha}_B \\
\mathbf{v}_n &= \mathbf{T}_B^\top \mathbf{v}_{n-1} \circ \mathbf{x}_n \\
W(A \cap B) &= \mathbf{v}_N^\top \boldsymbol{\omega}_B
\end{align}
</script></span></p>
</li>
</ol><h2 id="Current-implementation"><a class="anchor hidden-xs" href="#Current-implementation" title="Current-implementation"><i class="fa fa-link"></i></a>Current implementation</h2><p>FAST – Fast Speech Transcription:</p><ul>
<li><a href="https://src.koda.cnrs.fr/fast/*" target="_blank" rel="noopener">https://src.koda.cnrs.fr/fast/*</a>
<ul>
<li><a href="https://src.koda.cnrs.fr/fast/Semirings.jl" target="_blank" rel="noopener">https://src.koda.cnrs.fr/fast/Semirings.jl</a></li>
<li><a href="https://src.koda.cnrs.fr/fast/fsas" target="_blank" rel="noopener">https://src.koda.cnrs.fr/fast/fsas</a></li>
</ul>
</li>
</ul><blockquote>
<p>URLs will most likely change soon (will keep you updated).</p>
</blockquote><h1 id="Workshop"><a class="anchor hidden-xs" href="#Workshop" title="Workshop"><i class="fa fa-link"></i></a>Workshop</h1><h2 id="Common-objective"><a class="anchor hidden-xs" href="#Common-objective" title="Common-objective"><i class="fa fa-link"></i></a>Common objective</h2><ul>
<li>Build a streaming ASR system
<ul>
<li>Training:
<ul>
<li>GNAT+FAST to implement MMI &amp; sMBR</li>
<li>semi-supervised ?</li>
</ul>
</li>
<li>Inference:
<ul>
<li>Standard [WER]</li>
<li>Long-sequence decoding [WER/Time/Memory] (time alignment will provide the segmentation)</li>
<li>edge-cloud decoding [WER/Network load/Time/Memory]</li>
</ul>
</li>
</ul>
</li>
</ul><h2 id="Preparation"><a class="anchor hidden-xs" href="#Preparation" title="Preparation"><i class="fa fa-link"></i></a>Preparation</h2><ul>
<li>MMI training pipeline using FAST (Martin &amp; Lucas)
<ul>
<li>Connecting with Google:
<ul>
<li>GNAT -&gt; HC + LG &lt;- FAST</li>
</ul>
</li>
</ul>
</li>
<li>Helping one PhD to implement a long audio alignment:
<ul>
<li>
<blockquote>
<p><em>Exact Alpha-Beta Computation in Logarithmic Space with Application to MAP Word Graph Construction, 2000, G. Zweig et al.</em></p>
</blockquote>
</li>
<li>
<blockquote>
<p><em>Engineering Multimedia Applications on the basis of Multi-Structured Descriptions of Audiovisual Contents, 2007, M. Caillet et al.</em></p>
</blockquote>
</li>
</ul>
</li>
<li>Actively collaborating with FBK (intern coming in May) on ARM-based inference ?</li>
</ul><hr></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#A-Modern-View-of-FSA" title="A Modern View of FSA">A Modern View of FSA</a><ul class="nav">
<li class=""><a href="#Finite-State-Automata" title="Finite State Automata">Finite State Automata</a></li>
<li class=""><a href="#Regain-of-Interest-for-FSA" title="Regain of Interest for FSA">Regain of Interest for FSA</a></li>
<li class=""><a href="#A-Different-Path" title="A Different Path">A Different Path</a></li>
</ul>
</li>
<li class=""><a href="#Linear-Algebraic-Framework-for-FSA" title="Linear Algebraic Framework for FSA">Linear Algebraic Framework for FSA</a><ul class="nav">
<li class=""><a href="#Challenges" title="Challenges">Challenges</a></li>
<li class=""><a href="#Dual-representation-of-FSA" title="Dual representation of FSA">Dual representation of FSA</a></li>
<li class=""><a href="#Matrix-representation" title="Matrix representation">Matrix representation</a></li>
<li class=""><a href="#Implementing-a-FSA-based-Loss-Function" title="Implementing a FSA-based Loss Function">Implementing a FSA-based Loss Function</a><ul class="nav">
<li class=""><a href="#Challenges1" title="Challenges">Challenges</a></li>
</ul>
</li>
<li class=""><a href="#Representing-“ε”" title="Representing “ε”">Representing “ε”</a></li>
<li class=""><a href="#Building-the-decoding-graph" title="Building the decoding graph">Building the decoding graph</a></li>
<li class=""><a href="#Inference-with-neural-networks" title="Inference with neural networks">Inference with neural networks</a></li>
<li class=""><a href="#Current-implementation" title="Current implementation">Current implementation</a></li>
</ul>
</li>
<li class=""><a href="#Workshop" title="Workshop">Workshop</a><ul class="nav">
<li class=""><a href="#Common-objective" title="Common objective">Common objective</a></li>
<li class=""><a href="#Preparation" title="Preparation">Preparation</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu" style="">
    <a class="expand-toggle expand-all" href="#">Expand all</a>
    <a class="expand-toggle collapse-all" href="#" style="display: none;">Collapse all</a>
    <a class="back-to-top" href="#">Back to top</a>
    <a class="go-to-bottom" href="#">Go to bottom</a>
</div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#A-Modern-View-of-FSA" title="A Modern View of FSA">A Modern View of FSA</a><ul class="nav">
<li class=""><a href="#Finite-State-Automata" title="Finite State Automata">Finite State Automata</a></li>
<li class=""><a href="#Regain-of-Interest-for-FSA" title="Regain of Interest for FSA">Regain of Interest for FSA</a></li>
<li class=""><a href="#A-Different-Path" title="A Different Path">A Different Path</a></li>
</ul>
</li>
<li class=""><a href="#Linear-Algebraic-Framework-for-FSA" title="Linear Algebraic Framework for FSA">Linear Algebraic Framework for FSA</a><ul class="nav">
<li class=""><a href="#Challenges" title="Challenges">Challenges</a></li>
<li class=""><a href="#Dual-representation-of-FSA" title="Dual representation of FSA">Dual representation of FSA</a></li>
<li class=""><a href="#Matrix-representation" title="Matrix representation">Matrix representation</a></li>
<li class=""><a href="#Implementing-a-FSA-based-Loss-Function" title="Implementing a FSA-based Loss Function">Implementing a FSA-based Loss Function</a><ul class="nav">
<li class=""><a href="#Challenges1" title="Challenges">Challenges</a></li>
</ul>
</li>
<li class=""><a href="#Representing-“ε”" title="Representing “ε”">Representing “ε”</a></li>
<li class=""><a href="#Building-the-decoding-graph" title="Building the decoding graph">Building the decoding graph</a></li>
<li class=""><a href="#Inference-with-neural-networks" title="Inference with neural networks">Inference with neural networks</a></li>
<li class=""><a href="#Current-implementation" title="Current implementation">Current implementation</a></li>
</ul>
</li>
<li class=""><a href="#Workshop" title="Workshop">Workshop</a><ul class="nav">
<li class=""><a href="#Common-objective" title="Common objective">Common objective</a></li>
<li class=""><a href="#Preparation" title="Preparation">Preparation</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu" style="">
    <a class="expand-toggle expand-all" href="#">Expand all</a>
    <a class="expand-toggle collapse-all" href="#" style="display: none;">Collapse all</a>
    <a class="back-to-top" href="#">Back to top</a>
    <a class="go-to-bottom" href="#">Go to bottom</a>
</div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/js/bootstrap.min.js" integrity="sha256-kJrlY+s09+QoWjpkOrXXwhxeaoDz9FW5SaxF8I0DibQ=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
